<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mathematics and Computer Science for Machine Learning - 4&nbsp; Calculus</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notebooks/linear-systems.html" rel="next">
<link href="../notebooks/numerical-computing.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Calculus</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Mathematics and Computer Science for Machine Learning</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/programming.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Computer Programming</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/basic-math.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Basic Math</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/numerical-computing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Numerical Computation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/calculus.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Calculus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/linear-systems.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Linear Systems</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Vector Spaces</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/matrices.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Matrix Algebra</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/tensors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Tensor Algebra</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/multivariate-calculus.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Multivariate Calculus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/optimization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Optimization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/probability.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Basic Probability</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/multivariate-probability.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Multivariate Distributions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/statistics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Statistics</span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#infinitesimal-calculus" id="toc-infinitesimal-calculus" class="nav-link active" data-scroll-target="#infinitesimal-calculus"><span class="toc-section-number">4.1</span>  Infinitesimal Calculus</a>
  <ul class="collapse">
  <li><a href="#infinitesimals" id="toc-infinitesimals" class="nav-link" data-scroll-target="#infinitesimals"><span class="toc-section-number">4.1.1</span>  Infinitesimals</a></li>
  <li><a href="#infinitely-large-numbers" id="toc-infinitely-large-numbers" class="nav-link" data-scroll-target="#infinitely-large-numbers"><span class="toc-section-number">4.1.2</span>  Infinitely Large Numbers</a></li>
  <li><a href="#continuity" id="toc-continuity" class="nav-link" data-scroll-target="#continuity"><span class="toc-section-number">4.1.3</span>  Continuity</a></li>
  <li><a href="#limits" id="toc-limits" class="nav-link" data-scroll-target="#limits"><span class="toc-section-number">4.1.4</span>  Limits</a></li>
  <li><a href="#asymptotic-notation" id="toc-asymptotic-notation" class="nav-link" data-scroll-target="#asymptotic-notation"><span class="toc-section-number">4.1.5</span>  Asymptotic Notation</a></li>
  </ul></li>
  <li><a href="#differential-calculus" id="toc-differential-calculus" class="nav-link" data-scroll-target="#differential-calculus"><span class="toc-section-number">4.2</span>  Differential Calculus</a>
  <ul class="collapse">
  <li><a href="#differentials-and-derivatives" id="toc-differentials-and-derivatives" class="nav-link" data-scroll-target="#differentials-and-derivatives"><span class="toc-section-number">4.2.1</span>  Differentials and Derivatives</a></li>
  <li><a href="#interpreting-derivatives" id="toc-interpreting-derivatives" class="nav-link" data-scroll-target="#interpreting-derivatives"><span class="toc-section-number">4.2.2</span>  Interpreting Derivatives</a></li>
  <li><a href="#second-derivatives" id="toc-second-derivatives" class="nav-link" data-scroll-target="#second-derivatives"><span class="toc-section-number">4.2.3</span>  Second Derivatives</a></li>
  <li><a href="#differentiation-rules" id="toc-differentiation-rules" class="nav-link" data-scroll-target="#differentiation-rules"><span class="toc-section-number">4.2.4</span>  Differentiation Rules</a></li>
  </ul></li>
  <li><a href="#integral-calculus" id="toc-integral-calculus" class="nav-link" data-scroll-target="#integral-calculus"><span class="toc-section-number">4.3</span>  Integral Calculus</a>
  <ul class="collapse">
  <li><a href="#indefinite-integration" id="toc-indefinite-integration" class="nav-link" data-scroll-target="#indefinite-integration"><span class="toc-section-number">4.3.1</span>  Indefinite Integration</a></li>
  <li><a href="#definite-integration" id="toc-definite-integration" class="nav-link" data-scroll-target="#definite-integration"><span class="toc-section-number">4.3.2</span>  Definite Integration</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Calculus</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this lesson, I’ll cover the basics of the calculus of a single variable. Calculus is often divided into different areas, those being:</p>
<ul>
<li>Infinitesimals: How to manipulate numbers that are infinitely small or infinitely large.</li>
<li>Differentiation: How one variable changes continuously in response to one or more other variables.</li>
<li>Integration: How to add up infinitely many small numbers to get a finite number.</li>
</ul>
<p>Let’s get started.</p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> utils.math_ml <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="infinitesimal-calculus" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="infinitesimal-calculus"><span class="header-section-number">4.1</span> Infinitesimal Calculus</h2>
<section id="infinitesimals" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="infinitesimals"><span class="header-section-number">4.1.1</span> Infinitesimals</h3>
<p>Perhaps most fundamental to what calculus is is the idea of an infinitely small number, usually called an <em>infinitesimal</em>. A positive <strong>infinitesimal</strong> is a <em>hyperreal number</em> <span class="math inline">\(\varepsilon\)</span> that’s much smaller than any positive real number <span class="math inline">\(x\)</span>,</p>
<p><span class="math display">\[0 &lt; \varepsilon \ll x.\]</span></p>
<p>A negative infinitesimal is defined similarly, except with the signs all flipped, <span class="math inline">\(x \ll \varepsilon &lt; 0\)</span>. I say “hyperreal number” because infinitesimals aren’t technically real numbers. They extend the number line in a sense. Thankfully we won’t really have to worry about this technical distinction in this book.</p>
<p>For practical purposes, think of infinitesimals as a really, really small numbers. When we say infinitesimal in practice, we usually mean a really small number like <span class="math inline">\(\varepsilon = 10^{-10}\)</span>. This means <span class="math inline">\(\varepsilon^2 = 10^{-20}\)</span>. If we take say <span class="math inline">\(x=1\)</span>, then <span class="math inline">\(\varepsilon=10^{-10}\)</span> is really small compared to <span class="math inline">\(x\)</span>, but <span class="math inline">\(\varepsilon^2 = 10^{-20}\)</span> is really really small compared to <span class="math inline">\(x\)</span>, so small that it might as well be zero,</p>
<p><span class="math display">\[\varepsilon^2 \approx 0.\]</span></p>
<p>A computer wouldn’t even be able to tell the difference really between <span class="math inline">\(x\)</span> and <span class="math inline">\(x + \varepsilon^2\)</span>.</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>epsilon <span class="op">=</span> np.float64(<span class="fl">1e-10</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'x = </span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'epsilon = </span><span class="sc">{</span>epsilon<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'x + epsilon = </span><span class="sc">{</span><span class="dv">1</span> <span class="op">-</span> epsilon<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'epsilon^2 = </span><span class="sc">{</span>epsilon <span class="op">**</span> <span class="dv">2</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'x + epsilon^2 = </span><span class="sc">{</span><span class="dv">1</span> <span class="op">-</span> epsilon <span class="op">**</span> <span class="dv">2</span><span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>x = 1
epsilon = 1e-10
x + epsilon = 0.9999999999
epsilon^2 = 1.0000000000000001e-20
x + epsilon^2 = 1.0</code></pre>
</div>
</div>
<p>To see an example of how to work with infinitesimals, let’s try to simplify the expression <span class="math inline">\((1 + \varepsilon)^n\)</span>, assuming <span class="math inline">\(\varepsilon\)</span> is some infinitesimal added to <span class="math inline">\(1\)</span>, and <span class="math inline">\(n\)</span> is some positive integer. If we expand out the product in powers of <span class="math inline">\(\varepsilon\)</span>, we’d have</p>
<p><span class="math display">\[(1 + \varepsilon)^n = (1 + \varepsilon) (1 + \varepsilon) \cdots (1 + \varepsilon) = 1 + n\varepsilon + \frac{1}{2}n(n-1)\varepsilon^2 + \cdots + \varepsilon^n.\]</span></p>
<p>Now, since <span class="math inline">\(\varepsilon^2 \approx 0\)</span>, all the powers of order <span class="math inline">\(\varepsilon^2\)</span> or higher vanish, so we’re just left with</p>
<p><span class="math display">\[(1 + \varepsilon)^n \approx 1 + n\varepsilon.\]</span></p>
<p>This neat little approximation is called the <strong>binomial approximation</strong>. In fact, it holds for any real number <span class="math inline">\(n\)</span>, not just positive integers.</p>
</section>
<section id="infinitely-large-numbers" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="infinitely-large-numbers"><span class="header-section-number">4.1.2</span> Infinitely Large Numbers</h3>
<p>The inverse of an infinitesimal must evidently be a really big number <span class="math inline">\(N = \frac{1}{\varepsilon}\)</span>. These are called <em>infinitely large</em> numbers. Technically speaking, a positive <strong>infinitely large</strong> number is a hyperreal number that’s much larger than any positive real number <span class="math inline">\(x\)</span>,</p>
<p><span class="math display">\[0 \leq x \ll N.\]</span></p>
<p>Similarly for infinitely large negative numbers, we’d have <span class="math inline">\(N \ll x &lt; 0\)</span>.</p>
<p>If in practice we’d think of an infinitesimal as a tiny number like <span class="math inline">\(\varepsilon = 10^{-10}\)</span>, we’d think of an infinitely large number a really big number like <span class="math inline">\(N=10^{10}\)</span>. If <span class="math inline">\(N\)</span> is really big, then <span class="math inline">\(N^2\)</span> is really really big, so big that it might as well be infinity,</p>
<p><span class="math display">\[N^2 \approx \infty.\]</span></p>
<p>If <span class="math inline">\(x=1\)</span>, then <span class="math inline">\(x + N \approx N\)</span>. As far as a computer is concerned you can’t really even tell the difference.</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> np.float64(<span class="fl">1e10</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'x = </span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'N = </span><span class="sc">{</span>N<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'x + N = </span><span class="sc">{</span><span class="dv">1</span> <span class="op">+</span> N<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'N^2 = </span><span class="sc">{</span>N <span class="op">**</span> <span class="dv">2</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'x + N^2 = </span><span class="sc">{</span><span class="dv">1</span> <span class="op">+</span> N <span class="op">**</span> <span class="dv">2</span><span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>x = 1
N = 10000000000.0
x + N = 10000000001.0
N^2 = 1e+20
x + N^2 = 1e+20</code></pre>
</div>
</div>
</section>
<section id="continuity" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="continuity"><span class="header-section-number">4.1.3</span> Continuity</h3>
<p>Calculus is mainly concerned with the study of functions that are <em>continuous</em>. Informally speaking, a function is continuous if its graph has no breaks in it. You could draw the graph on a piece of paper without lifting your pen. A better way of saying the same thing is that each point on the graph always has points infinitesimally close to it.</p>
<p>Formally speaking, we’d say a function <span class="math inline">\(y=f(x)\)</span> is <strong>continuous</strong> at a point <span class="math inline">\(a\)</span> if <span class="math inline">\(f(x)\)</span> is infinitesimally close to <span class="math inline">\(f(a)\)</span> whenever <span class="math inline">\(x\)</span> is infinitesimally close to <span class="math inline">\(a\)</span>. That is, any points nearby <span class="math inline">\(a\)</span> must get mapped to points nearby <span class="math inline">\(f(a)\)</span>. The function itself is called continuous if it’s continuous for <em>every</em> choice of <span class="math inline">\(a\)</span>.</p>
<p>Just about every function you’re familiar with is continuous. Constant functions, linear functions, affine functions, polynomials, exponentials, logarithms, roots, they’re all continuous. There are no breaks in their graphs.</p>
<p>One example of a function that <em>is not</em> continuous is the step function <span class="math inline">\(y=u(x)\)</span> given by,</p>
<p><span class="math display">\[y =
\begin{cases}
1, &amp; x \geq 0 \\
0, &amp; x &lt; 0. \\
\end{cases}
\]</span></p>
<p>This function is continuous for every <span class="math inline">\(x \neq 0\)</span>, but at <span class="math inline">\(x=0\)</span> there’s a discontinuous jump from <span class="math inline">\(y=0\)</span> to <span class="math inline">\(y=1\)</span>. If I pick any negative <span class="math inline">\(x\)</span> infinitesimally close to <span class="math inline">\(0\)</span> it’ll have <span class="math inline">\(f(x)=0\)</span>, which is not infinitesimally close to <span class="math inline">\(f(0)=1\)</span>.</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x:  (x <span class="op">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>plot_function(x, f, xlim<span class="op">=</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>), ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>), ticks_every<span class="op">=</span>[<span class="dv">1</span>, <span class="fl">0.5</span>], </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>              title<span class="op">=</span><span class="st">'$y=u(x)$'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="calculus_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Step type functions aren’t the only examples of discontinuous functions though. Any function with a <em>pole</em> or <em>asymptote</em> will have a discontinuity at those points. For example, the rational function</p>
<p><span class="math display">\[y=\frac{x^3+x+1}{x^2-1}.\]</span></p>
<p>evidently has poles at <span class="math inline">\(x = \pm 1\)</span>, which means the function will be discontinuous at these two points. Everywhere else it’s continuous.</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: (x <span class="op">**</span> <span class="dv">3</span> <span class="op">+</span> x <span class="op">+</span> <span class="dv">1</span>) <span class="op">/</span> (x <span class="op">**</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>plot_function(x, f, xlim<span class="op">=</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>), ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>), ticks_every<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">1</span>], </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>              title<span class="op">=</span><span class="st">'$y = (x^3 + x + 1) / (x^2 - 1)$'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="calculus_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In practice these continuity distinctions usually don’t matter a whole lot. Step functions and rational functions are continuous <em>almost everywhere</em>. For all but a small handful of values everything’s fine and we can apply calculus as usual. However, there are pathological cases out there of functions that are <em>nowhere continuous</em>. An example might be any function generated by a random number generator. The points never connect. They’re all over the place. Functions like these we wouldn’t try to treat using calculus, at least directly.</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: np.random.rand(<span class="bu">len</span>(x))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>, <span class="dv">3</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, f(x), s<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$y=rand(x)$'</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$x$'</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$y$'</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="calculus_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="limits" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="limits"><span class="header-section-number">4.1.4</span> Limits</h3>
<p>For historical reasons, most modern calculus books don’t talk about infinitesimals or infinitely large numbers at all. It’s not because they’re not rigorous, at least anymore. It mostly has to do with the history of calculus. For a long time people had a hard time rigorously pinning down what exactly these infinitely small numbers were. To get around this, in the 19th century many mathematicians started to think instead in terms of <a href="https://en.wikipedia.org/wiki/Limit_(mathematics)">limits</a>.</p>
<p>In the language of infinitesimals, we’d say that the <strong>limit</strong> of a function <span class="math inline">\(y=f(x)\)</span> as <span class="math inline">\(x\)</span> approaches some value <span class="math inline">\(a\)</span> is the value <span class="math inline">\(L\)</span> such that</p>
<p><span class="math display">\[L \approx f(a + \varepsilon),\]</span></p>
<p>where <span class="math inline">\(\varepsilon\)</span> is any nonzero infinitesimal added to <span class="math inline">\(a\)</span>. Said differently, <span class="math inline">\(f(x) \approx L\)</span> whenever <span class="math inline">\(x \approx a\)</span> but <span class="math inline">\(x \neq a\)</span>. Limits are usually written with the notation</p>
<p><span class="math display">\[\lim_{x \rightarrow a} f(x) = L.\]</span></p>
<p>In the language of limits, we’d think of <span class="math inline">\(x\)</span> being some value that gets closer and closer to <span class="math inline">\(a\)</span>, which then causes <span class="math inline">\(f(x)\)</span> to get closer and closer to <span class="math inline">\(L\)</span>. This is a more dynamic view of calculus, where you imagine values moving towards a point instead of just nudging that point by some really small value.</p>
<p>I personally find that the language of limits tends to complicate understanding of calculus. Anything phrased in terms of limits pretty much can be more easily phrased in terms of infinitesimals. Nevertheless, it’s good to know how to calculate limits. For continuous functions it’s easy. As long as <span class="math inline">\(a\)</span> is a finite value and <span class="math inline">\(f(x)\)</span> is continuous at <span class="math inline">\(x=a\)</span>, then the limit is just given by plugging in <span class="math inline">\(f(a)\)</span> directly, i.e.</p>
<p><span class="math display">\[\lim_{x \rightarrow a} f(x) = f(a).\]</span></p>
<p>For example, suppose we wanted to take the limit of <span class="math inline">\(y = x^3 - 10x^2\)</span> as <span class="math inline">\(x \rightarrow 1\)</span>. Since this function is continuous, the limit would be</p>
<p><span class="math display">\[\lim_{x \rightarrow 1} (x^3 - 10x^2) = 1^3 - 10 \cdot 1^2 = 1 - 10 = -9.\]</span></p>
<p>When the function isn’t continuous you have to be more careful and actually add an infinitesimal to <span class="math inline">\(a\)</span> to see what the function is doing nearby. It may be the case that what the function is doing to the left at <span class="math inline">\(a-\varepsilon\)</span> is different from what the function is doing to the right at <span class="math inline">\(a+\varepsilon\)</span>. In that case the ordinary limit doesn’t exist and we have to talk about <em>one-sided</em> limits. I won’t spend time on these.</p>
<p>Another important case not covered by just plugging in <span class="math inline">\(f(a)\)</span> directly is when we’re interested in <em>infinite limits</em>. That is, when <span class="math inline">\(x \rightarrow \infty\)</span> or <span class="math inline">\(x \rightarrow -\infty\)</span>. In these cases we have to plug in an infinitely large number <span class="math inline">\(N\)</span> and look at what’s happening as <span class="math inline">\(N\)</span> gets really big. For example, suppose we wanted to take the limit of <span class="math inline">\(y = x^3 - 10x^2\)</span> as <span class="math inline">\(x \rightarrow \infty\)</span>. If we plug an infinitely large number into this function we’d get <span class="math inline">\(f(N) = N^3 - 10N^2\)</span>. Since <span class="math inline">\(N^3 \gg N^2\)</span> when <span class="math inline">\(N\)</span> is really big, we’d have <span class="math inline">\(f(N) \approx N^3\)</span>. This is a cubic function, which of course goes off to infinity as <span class="math inline">\(N\)</span> gets large. That is,</p>
<p><span class="math display">\[\lim_{x \rightarrow \infty} (x^3 - 10x^2) = \infty.\]</span></p>
<p>As a more interesting example, suppose we wanted to take the limit of the following rational function as <span class="math inline">\(x \rightarrow \infty\)</span>,</p>
<p><span class="math display">\[y = \frac{7x^5 + x^3 - x + 1}{2x^5 - 3x^3 + x^2 - 4}.\]</span></p>
<p>If we plot this function, we can see that it’s evidently approaching some finite value as <span class="math inline">\(x\)</span> gets large, something like <span class="math inline">\(y = 3.5\)</span>.</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">100</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: (<span class="dv">7</span> <span class="op">*</span> x<span class="op">**</span><span class="dv">5</span> <span class="op">+</span> x<span class="op">**</span><span class="dv">3</span> <span class="op">-</span> x <span class="op">+</span> <span class="dv">1</span>) <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> x<span class="op">**</span><span class="dv">5</span> <span class="op">-</span> <span class="dv">3</span> <span class="op">*</span> x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">4</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>plot_function(x, f, xlim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">20</span>), ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">5</span>), ticks_every<span class="op">=</span>[<span class="dv">2</span>, <span class="dv">1</span>], title_fontsize<span class="op">=</span><span class="dv">13</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>              title<span class="op">=</span><span class="st">'$y=</span><span class="ch">\\</span><span class="st">frac{7x^5 + x^3 - x + 1}{2x^5 - 3x^3 + x^2 - 4}$ as $x </span><span class="ch">\\</span><span class="st">rightarrow \infty$'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="calculus_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>In fact, it goes like the ratio of the leading powers in the numerator and denominator. If <span class="math inline">\(N\)</span> is infinitely large, then</p>
<p><span class="math display">\[f(N) \approx \frac{7N^5}{2N^5} = \frac{7}{2} = 3.5.\]</span></p>
<p>This is a general fact for rational functions as <span class="math inline">\(x \rightarrow \infty\)</span>. The final limit we seek is thus</p>
<p><span class="math display">\[\lim_{x \rightarrow \infty} \frac{7x^5 + x^3 - x + 1}{2x^5 - 3x^3 + x^2 - 4} = \frac{7}{2} = 3.5.\]</span></p>
<p>With infinite limits, when in doubt, plot the function and see if it’s stabilizing to some value or going off to positive or negative infinity. Or just code up the function and plug in some large values. The vast majority of the time you’ll get the right answer.</p>
</section>
<section id="asymptotic-notation" class="level3" data-number="4.1.5">
<h3 data-number="4.1.5" class="anchored" data-anchor-id="asymptotic-notation"><span class="header-section-number">4.1.5</span> Asymptotic Notation</h3>
<p>At their core, infinitesimals and infinitely large numbers are most useful for getting approximations to functions. Infinitesimals are useful when we want to know how a function behaves near <em>zero</em>. Infinitely large numbers are useful when we want to know how a function behaves near <em>infinity</em>. We can use these two notions to define a convenient simplified notation called <strong>asymptotic notation</strong> or <strong>big-O notation</strong>. Asymptotic notation is used to give us a general idea how a function behaves in extreme limits. It ignores the finer details of the function and just focuses on its growth behavior. This notation is extremely pervasive across computer science and applied mathematics, and well worth being familiar with.</p>
<p>Suppose <span class="math inline">\(f(x)\)</span> is some function. We say <span class="math inline">\(f(x) = O(g(x))\)</span> <em>in the infinite limit</em> if for any infinitely large number <span class="math inline">\(N\)</span>, <span class="math inline">\(f(N)\)</span> is bounded above by some real-valued constant multiple of <span class="math inline">\(g(N)\)</span>,</p>
<p><span class="math display">\[f(N) \leq C \cdot g(N).\]</span></p>
<p>Informally, this says the graph of <span class="math inline">\(f(x)\)</span> lies under some constant multiple of the graph of <span class="math inline">\(g(x)\)</span> when <span class="math inline">\(x\)</span> is large. It doesn’t mean that <span class="math inline">\(C \cdot g(x)\)</span> is <em>always</em> bigger than <span class="math inline">\(f(x)\)</span>. It means that if <span class="math inline">\(x\)</span> increases <em>eventually</em> there will come a point where <span class="math inline">\(C \cdot g(x)\)</span> is bigger than <span class="math inline">\(f(x)\)</span>.</p>
<p>Similarly, we say <span class="math inline">\(f(x) = \mathcal{O}(h(x))\)</span> <em>in the zero limit</em> if for any infinitesimal <span class="math inline">\(\varepsilon\)</span>, <span class="math inline">\(f(\varepsilon)\)</span> is bounded above by some real-valued constant multiple of <span class="math inline">\(g(\varepsilon)\)</span>,</p>
<p><span class="math display">\[f(\varepsilon) \leq C \cdot h(\varepsilon).\]</span></p>
<p>Informally, this says the graph of <span class="math inline">\(f(x)\)</span> lies under some constant multiple of the graph of <span class="math inline">\(h(x)\)</span> when <span class="math inline">\(x\)</span> is small. Again, it doesn’t mean that <span class="math inline">\(C \cdot g(x)\)</span> is <em>always</em> bigger than <span class="math inline">\(f(x)\)</span>. It means that if <span class="math inline">\(x\)</span> gets smaller and smaller, <em>eventually</em> there will come a point where <span class="math inline">\(C \cdot g(x)\)</span> is bigger than <span class="math inline">\(f(x)\)</span>.</p>
<p>Let’s look at a simple example. Consider the cubic function</p>
<p><span class="math display">\[f(x) = x^3 + 2x^2 - x + 2.\]</span></p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> x <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>plot_function(x, f, xlim<span class="op">=</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>), ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">7</span>), ticks_every<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="calculus_files/figure-html/cell-9-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Let’s first ask what the function is doing as <span class="math inline">\(x\)</span> gets <em>infinitely large</em>. It should be pretty clear from the graph that it’s shooting up to infinity. But how fast? Take <span class="math inline">\(N\)</span> to be infinitely large. Then</p>
<p><span class="math display">\[f(N) = N^3 + 2N^2 - N - 1.\]</span></p>
<p>Now, if <span class="math inline">\(N\)</span> is infinitely large, then <span class="math inline">\(N\)</span> will be huge compared to <span class="math inline">\(1\)</span>, but <span class="math inline">\(N^2\)</span> will be big compared to <span class="math inline">\(N\)</span> too, and <span class="math inline">\(N^3\)</span> will be big compared to <span class="math inline">\(N^2\)</span>. That is,</p>
<p><span class="math display">\[N^3 \gg N^2 \gg N \gg 1.\]</span></p>
<p>If we approximate the function with its <em>highest order</em> term, we just have</p>
<p><span class="math display">\[f(N) \approx N^3.\]</span></p>
<p>That is, near infinity, <span class="math inline">\(f(x)\)</span> grows like the ordinary cubic function <span class="math inline">\(g(x) = x^3\)</span>. But is there some constant <span class="math inline">\(C\)</span> we can scale <span class="math inline">\(g(x)\)</span> by so that <span class="math inline">\(f(N) \leq C \cdot g(x)\)</span>? Yes there is. Observe that near infinity we have</p>
<p><span class="math display">\[f(N) = N^3 + 2N^2 - N - 1 \leq N^3 + 2N^3 + N^3 + N^3 = 5N^3.\]</span></p>
<p>That is, if <span class="math inline">\(C=5\)</span>, then <span class="math inline">\(f(N) \leq C \cdot g(x)\)</span>. In the infinite limit we thus have</p>
<p><span class="math display">\[x^3 + 2x^2 - x + 2 = O(x^3).\]</span></p>
<p>This is just a fancy way of saying that our function <span class="math inline">\(f(x)\)</span> lies on or below the curve <span class="math inline">\(y=5x^3\)</span> when <span class="math inline">\(x\)</span> gets really big.</p>
<p>Let’s now ask what the function is doing as <span class="math inline">\(x\)</span> becomes <em>infinitesimal</em>. It looks like it takes on the value <span class="math inline">\(y=-1\)</span> at <span class="math inline">\(x=0\)</span>. To see what the function is doing <em>near</em> zero, we can look at <span class="math inline">\(y=f(\varepsilon)\)</span> assuming <span class="math inline">\(\varepsilon\)</span> is infinitesimal,</p>
<p><span class="math display">\[f(\varepsilon) \approx \varepsilon^3 + 2\varepsilon^2 - \varepsilon + 2.\]</span></p>
<p>Now, if <span class="math inline">\(\varepsilon\)</span> is tiny, then <span class="math inline">\(\varepsilon^2\)</span> is really tiny, and <span class="math inline">\(\varepsilon^3\)</span> is really really tiny. That is,</p>
<p><span class="math display">\[\varepsilon^3 \ll \varepsilon^2 \ll \varepsilon \ll 1.\]</span></p>
<p>If we approximate the function with its <em>lowest order</em> term, we just have</p>
<p><span class="math display">\[f(\varepsilon) \approx 2.\]</span></p>
<p>That is, very close to zero the function behaves like the constant function <span class="math inline">\(h(x) = 2\)</span>. Since we can just write <span class="math inline">\(2 = 2 \cdot 1\)</span>, we might as well factor the <span class="math inline">\(2\)</span> into the constant <span class="math inline">\(C\)</span> and just take <span class="math inline">\(h(x) = 1\)</span>. Then in the zero limit we have</p>
<p><span class="math display">\[x^3 + 2x^2 - x + 2 = \mathcal{O}(1).\]</span></p>
<p>This just says that our function <span class="math inline">\(f(x)\)</span> lies on or below the line <span class="math inline">\(y=2\)</span> when <span class="math inline">\(x\)</span> gets close to zero. Notice that you could’ve also gotten the same result by just evaluating <span class="math inline">\(f(0)\)</span> directly to get <span class="math inline">\(f(0) = 2\)</span>. This is because this particular function is <em>continuous</em>.</p>
<p>Here’s a plot so you can see what’s going on here. Notice that near zero, <span class="math inline">\(f(x) \leq 2.5 \cdot h(x) = 2.5\)</span>, and near infinity <span class="math inline">\(f(x) \leq 3 \cdot g(x) = 3x^3\)</span>.</p>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> x <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>g_inf <span class="op">=</span> <span class="kw">lambda</span> x: <span class="dv">5</span> <span class="op">*</span> x<span class="op">**</span><span class="dv">3</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>g_0 <span class="op">=</span> <span class="kw">lambda</span> x: <span class="fl">2.5</span> <span class="op">+</span> <span class="dv">0</span> <span class="op">*</span> x</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>plot_function(x, [f, g_inf, g_0], xlim<span class="op">=</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>), ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), ticks_every<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">1</span>], figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">4</span>),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>              labels<span class="op">=</span>[<span class="st">'$f(x)$'</span>, <span class="st">'$5g(x)$'</span>, <span class="st">'$2.5 h(x)$'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="calculus_files/figure-html/cell-10-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>What I’ve just shown more or less holds true for <em>any</em> polynomial. If <span class="math inline">\(f(x) = a_0 + a_1 x + \cdots + a_n x^n\)</span> is some degree <span class="math inline">\(n\)</span> polynomial, then in the <em>infinite limit</em> the <em>highest degree term</em> dominates, i.e.&nbsp;<span class="math inline">\(f(x) = O(x^n)\)</span>. In the <em>zero limit</em> the <em>lowest degree term</em> dominates, i.e.&nbsp;<span class="math inline">\(f(x) = \mathcal{O}(1)\)</span> provided <span class="math inline">\(a_0 \neq 0\)</span>. If you remember nothing else about asymptotic notation, at least remember these two facts.</p>
<p>The same rule holds not just for polynomials, but for any function of powers, including rational and root functions. The most important difference here is that the lowest degree term won’t usually be a constant. It’ll be the term with the most negative power. For example, in the zero limit</p>
<p><span class="math display">\[\sqrt{10 x} + x^{3/2} + \frac{7}{x^3} = \mathcal{O}\bigg(\frac{1}{x^3} \bigg).\]</span></p>
<p>Exponential and logarithmic functions lie on the extremes of the polynomials. In the infinite limit, the function <span class="math inline">\(f(x) = e^x\)</span> will be larger than <em>any</em> power of <span class="math inline">\(x\)</span>. On the other hand, the log function <span class="math inline">\(f(x) = \log x\)</span> grows <em>slower</em> than any power of <span class="math inline">\(x\)</span>. The trig functions <span class="math inline">\(f(x) = \sin x\)</span> and <span class="math inline">\(f(x) = \cos x\)</span> are both of order one in both limits since they’re always bounded by <span class="math inline">\(y=\pm 1\)</span>.</p>
<p>Here are a few more general examples of working with asymptotic notation in both limits.</p>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 30%">
<col style="width: 36%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Function</strong></td>
<td style="text-align: left;"><strong>Infinite Limit</strong></td>
<td style="text-align: left;"><strong>Zero Limit</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(f(x)=100\)</span></td>
<td style="text-align: left;"><span class="math inline">\(O(1)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(O(1)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(f(x)=-x^4 + 2x^3 + 4x^2 + 8x + 16\)</span></td>
<td style="text-align: left;"><span class="math inline">\(O(x^4)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\mathcal{O}(1)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(f(x)=4x^5 + 3x^4 + 2x^3 + x^2 + x\)</span></td>
<td style="text-align: left;"><span class="math inline">\(O(x^5)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\mathcal{O}(x)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(f(x)=\sqrt{10 x} + x^{3/2} + \frac{7}{x^3}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(O(x^{3/2})\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\mathcal{O}\big(\frac{1}{x^3} \big)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(f(x)=10 e^x + 100 x^{1000} + x^3\)</span></td>
<td style="text-align: left;"><span class="math inline">\(O(e^x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\mathcal{O}(x^3)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(f(x)=\log 50x - 5 x + 30 x^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(O(x^2)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\mathcal{O}(\log x)\)</span></td>
</tr>
</tbody>
</table>
<p>When in doubt, when you want to figure out the asymptotic behavior of a function, plot it and see what it’s doing in the limit of interest. Here’s a plot of some common functions, zoomed out so we can get an idea of the infinite limit. Notice how exponential function quickly out-grows everything else. Next come the polynomials and roots ordered by the highest powers. Then the logarithms. Then the constant functions. And finally the negative powers.</p>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">100</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> [<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="op">/</span> x<span class="op">**</span><span class="dv">2</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>      <span class="kw">lambda</span> x: <span class="dv">1</span> <span class="op">/</span> x,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>      <span class="kw">lambda</span> x:  <span class="dv">0</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">1</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>      <span class="kw">lambda</span> x:  np.log(x), </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>      <span class="kw">lambda</span> x:  x,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>      <span class="kw">lambda</span> x: np.sqrt(x),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>      <span class="kw">lambda</span> x:  x <span class="op">**</span> <span class="dv">2</span>, </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>      <span class="kw">lambda</span> x:  np.exp(x)]</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>plot_function(x, fs, xlim<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">10</span>), ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), ticks_every<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">1</span>], figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">4</span>),</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>              title<span class="op">=</span><span class="st">'Infinite Limit'</span>, legend_loc<span class="op">=</span><span class="st">'upper right'</span>, legend_fontsize<span class="op">=</span><span class="dv">9</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>              labels<span class="op">=</span>[<span class="st">'$y = 1/x^2$'</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'$y = 1/x$'</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'$y=1$'</span>, </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'$y = \log x$'</span>, </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'$y = x$'</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'$y = \sqrt</span><span class="sc">{x}</span><span class="st">$'</span>,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'$y=x^2$'</span>,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'$y = e^x$'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="calculus_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>And here’s a plot of the same functions, zoomed in near zero to get an idea of the zero limit. Notice now how everything’s flipped around. It’s the negative powers that are the largest, followed by constant functions, then logs, then powers and roots. The exponential is the smallest one.</p>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> [<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="op">/</span> x<span class="op">**</span><span class="dv">2</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>      <span class="kw">lambda</span> x: <span class="dv">1</span> <span class="op">/</span> x,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>      <span class="kw">lambda</span> x:  <span class="dv">0</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">1</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>      <span class="kw">lambda</span> x:  np.log(x), </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>      <span class="kw">lambda</span> x:  x,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>      <span class="kw">lambda</span> x: np.sqrt(x),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>      <span class="kw">lambda</span> x:  x <span class="op">**</span> <span class="dv">2</span>, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>      <span class="kw">lambda</span> x:  np.exp(x)]</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>plot_function(x, fs, xlim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>), ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">5</span>), ticks_every<span class="op">=</span>[<span class="fl">0.2</span>, <span class="dv">1</span>], figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">4</span>),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>              title<span class="op">=</span><span class="st">'Zero Limit'</span>, legend_loc<span class="op">=</span><span class="st">'upper right'</span>, legend_fontsize<span class="op">=</span><span class="dv">9</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>              labels<span class="op">=</span>[<span class="st">'$y = 1/x^2$'</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'$y = 1/x$'</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'$y=1$'</span>, </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'$y = \log x$'</span>, </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'$y = x$'</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'$y = \sqrt</span><span class="sc">{x}</span><span class="st">$'</span>,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'$y=x^2$'</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'$y = e^x$'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="calculus_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Note that frequently we omit which limit we’re talking about when we use asymptotic notation, assuming that it’s understood which limit we’re using in a given context. For example, when talking about the runtime, FLOPs, or memory of an algorithm, it’s always understood we’re in the <em>infinite limit</em>. When we’re talking about approximation errors or the convergence of numerical algorithms it’s understood we’re in the <em>zero limit</em>. In this book, I’ll use the italic big-O <span class="math inline">\(O(\cdot)\)</span> to refer to the infinite limit, and the script big-O <span class="math inline">\(\mathcal{O}(\cdot)\)</span> to refer to the zero limit. Usually you’ll be able to tell which I’m talking about by the context.</p>
</section>
</section>
<section id="differential-calculus" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="differential-calculus"><span class="header-section-number">4.2</span> Differential Calculus</h2>
<section id="differentials-and-derivatives" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="differentials-and-derivatives"><span class="header-section-number">4.2.1</span> Differentials and Derivatives</h3>
<p>To make it easier to tell what’s an infinitesimal with respect to what in a function, we often use the notation of <em>differentials</em>. If <span class="math inline">\(x\)</span> is some variable, we’d denote any infinitesimal added to it by the symbol <span class="math inline">\(dx\)</span>, called the <strong>differential</strong> of <span class="math inline">\(x\)</span>. If <span class="math inline">\(y=f(x)\)</span> is some function of <span class="math inline">\(x\)</span>, then the differential with respect to <span class="math inline">\(y\)</span> is the amount that <span class="math inline">\(y\)</span> changes if we change <span class="math inline">\(x\)</span> to <span class="math inline">\(x+dx\)</span>,</p>
<p><span class="math display">\[dy = f(x+dx) - f(x).\]</span></p>
<p>If it helps, you can think of <span class="math inline">\(dx\)</span> as meaning “a little bit of <span class="math inline">\(x\)</span>”, and <span class="math inline">\(dy\)</span> as meaning “a little bit of <span class="math inline">\(y\)</span>”.</p>
<p>Let’s look at an example. Suppose <span class="math inline">\(y=x^2\)</span>. What is <span class="math inline">\(dy\)</span>? Evidently, we’d have</p>
<p><span class="math display">\[dy = f(x + dx) - f(x) = (x+dx)^2 - x^2 = (x^2 + 2xdx + dx^2) - x^2 = 2xdx + dx^2.\]</span></p>
<p>This is how much <span class="math inline">\(y\)</span> changes if we change <span class="math inline">\(x\)</span> by <span class="math inline">\(dx\)</span>. Now, if <span class="math inline">\(dx\)</span> is infinitesimal, <span class="math inline">\(dx^2 \approx 0\)</span>, which means</p>
<p><span class="math display">\[dy \approx 2xdx.\]</span></p>
<p>Notice how if <span class="math inline">\(dx\)</span> is infinitesimal, then <span class="math inline">\(dy\)</span> will evidently be an infinitesimal too. If we change <span class="math inline">\(x=1\)</span> by a really small amount <span class="math inline">\(dx=10^{-10}\)</span>, then we’d change <span class="math inline">\(y=x^2=1\)</span> by <span class="math inline">\(dy=2xdx=2 \cdot 10^{-10}\)</span>, which is also a really small change.</p>
<p>The ratio of these differentials says something about the rate that <span class="math inline">\(y\)</span> changes if we change <span class="math inline">\(x\)</span>. It’s called the <em>derivative</em> of <span class="math inline">\(y=x^2\)</span>,</p>
<p><span class="math display">\[\frac{dy}{dx} = 2x.\]</span></p>
<p>Notice that the derivative is not itself infinitesimal since all the differentials are on the left-hand side. It’s a real number, on the same scale as <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<p>Of course, we can calculate these things numerically too. We just have to be careful about floating point roundoff. Since we’re subtracting two numbers that are almost equal we’ll inevitably get a lot of roundoff if we make <span class="math inline">\(dx\)</span> too small. When coding these things you have to be careful about how small you choose <span class="math inline">\(dx\)</span>. I’ll take <span class="math inline">\(dx=10^{-5}\)</span> here. If the calculation were exact, we’d expect to get</p>
<p><span class="math display">\[dy=2xdx = 2 \cdot 10^{-5} = 0.00002.\]</span></p>
<p>But evidently we don’t get this exactly. In fact, since <span class="math inline">\(dx^2 = 10^{-10}\)</span>, we should expect to start seeing errors around 10 decimal places due to <span class="math inline">\(dx\)</span> not being exactly infinitesimal, which is what we’re seeing here.</p>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> <span class="fl">1e-5</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">1</span> <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>dy <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> dx) <span class="op">**</span> <span class="dv">2</span> <span class="op">-</span> y</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'dy = </span><span class="sc">{</span>dy<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'dy/dx = </span><span class="sc">{</span>dy <span class="op">/</span> dx<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>dy = 2.0000100000139298e-05
dy/dx = 2.00001000001393</code></pre>
</div>
</div>
<p>Let’s do another example. Suppose we have the function <span class="math inline">\(y = x^3\)</span>. Then we’d have</p>
<p><span class="math display">\[dy = f(x+dx) - f(x) = (x+dx)^3 - x^3 = (x^3 + 3x^2 dx + 3 x dx^2 + dx^3) - x^3 = 3x^2 dx + 3 x dx^2 + dx^3.\]</span></p>
<p>If <span class="math inline">\(dx\)</span> is infinitesimal, then <span class="math inline">\(dx^2 \approx 0\)</span>, which also means <span class="math inline">\(dx^3 \approx 0\)</span>. Thus, if <span class="math inline">\(x\)</span> changes by a small amount <span class="math inline">\(dx\)</span>, then <span class="math inline">\(y=x^3\)</span> changes by an amount</p>
<p><span class="math display">\[dy = 3x^2 dx.\]</span></p>
<p>The derivative of <span class="math inline">\(y=x^3\)</span> is again just the ratio of differentials,</p>
<p><span class="math display">\[\frac{dy}{dx} = 3x^2.\]</span></p>
<p>Here’s a numerical calculation to verify this fact. I’ll again choose <span class="math inline">\(x=1\)</span> and <span class="math inline">\(dx=10^{-5}\)</span>. We should expect to get <span class="math inline">\(dy =3 \cdot 10^{-5}\)</span> and <span class="math inline">\(\frac{dy}{dx} = 3\)</span>. To within an error of about <span class="math inline">\(dx^2=10^{-10}\)</span> it seems we do.</p>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> <span class="fl">1e-5</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">1</span> <span class="op">**</span> <span class="dv">3</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>dy <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> dx) <span class="op">**</span> <span class="dv">3</span> <span class="op">-</span> y</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'dy = </span><span class="sc">{</span>dy<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'dy/dx = </span><span class="sc">{</span>dy <span class="op">/</span> dx<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>dy = 3.0000300001109537e-05
dy/dx = 3.000030000110953</code></pre>
</div>
</div>
<p>In both examples, the amount that <span class="math inline">\(y\)</span> changes if <span class="math inline">\(x\)</span> changes by <span class="math inline">\(dx\)</span> is evidently just the derivative times <span class="math inline">\(dx\)</span>,</p>
<p><span class="math display">\[dy = \frac{dy}{dx} dx.\]</span></p>
<p>The notation makes this fact look pretty trivial, since we can imagine canceling the <span class="math inline">\(dx\)</span> terms on the right to get <span class="math inline">\(dy\)</span>. In fact, that’s exactly what we’re doing.</p>
<p>In general, if <span class="math inline">\(y=f(x)\)</span> is some function that’s reasonably well-behaved at a point <span class="math inline">\(x\)</span>, then the <strong>differential</strong> of <span class="math inline">\(y\)</span> at that point is</p>
<p><span class="math display">\[dy = f(x+dx) - f(x),\]</span></p>
<p>and the <strong>derivative</strong> of <span class="math inline">\(y=f(x)\)</span> at that point is given by</p>
<p><span class="math display">\[\frac{dy}{dx} = \frac{f(x+dx) - f(x)}{dx}.\]</span></p>
<p>This equality is exact provided <span class="math inline">\(dx\)</span> is infinitesimal. Notice that both the differential and the derivative are themselves functions of <span class="math inline">\(x\)</span>. For this reason, it’s common to think of <span class="math inline">\(\frac{d}{dx}\)</span> is some kind of derivative operator and write</p>
<p><span class="math display">\[\frac{dy}{dx} = \frac{d}{dx} f(x), \quad \text{or} \quad \frac{dy}{dx} = f'(x).\]</span></p>
<p>What exactly did I mean when I said the function <span class="math inline">\(f(x)\)</span> needs to be “reasonably well behaved” at the point <span class="math inline">\(x\)</span>? For one thing, the function needs to be <strong>continuous</strong>. Continuity is what ensures that <span class="math inline">\(dy = f(x+dx) - f(x)\)</span> will be infinitesimal whenever <span class="math inline">\(dx\)</span> is infinitesimal. However, continuity is just a <em>necessary condition</em> for <span class="math inline">\(f(x)\)</span> to be differentiable. It’s also necessary that the ratio</p>
<p><span class="math display">\[\frac{dy}{dx} = \frac{f(x+dx) - f(x)}{dx}\]</span></p>
<p>shouldn’t depend on choice of <span class="math inline">\(dx\)</span>. Provided <span class="math inline">\(dx\)</span> is infinitesimal, <span class="math inline">\(\frac{dy}{dx}\)</span> should always be exactly the same number. This won’t be the case, for example, at points where there are kinks in the function’s graph. A major example of this is the ReLU function, which has a kink at <span class="math inline">\(x=0\)</span>. In practice though these kinks aren’t a huge problem. For example, for <em>convex</em> functions like the ReLU, we can slightly extend the notion of a derivative to the notion of a <a href="https://en.wikipedia.org/wiki/Subderivative">subderivative</a>.</p>
<p>When calculating a derivative numerically we have to account for the fact that realistically <span class="math inline">\(dx\)</span> will <em>not</em> be infinitesimal. That means there will be an <em>error</em> when dividing <span class="math inline">\(dy\)</span> by <span class="math inline">\(dx\)</span> to get the derivative. We got the differential <span class="math inline">\(dy\)</span> by dropping terms of order <span class="math inline">\(dx^2\)</span>. If we keep those terms, then dividing <span class="math inline">\(dy\)</span> by <span class="math inline">\(dx\)</span> will leave an error of order <span class="math inline">\(dx\)</span>. That is,</p>
<p><span class="math display">\[\frac{dy}{dx} = \frac{f(x+dx) - f(x)}{dx} + \mathcal{O}(dx).\]</span></p>
<p>Here’s a quick python function <code>diff</code> that can numerically calculate the derivative of some function <span class="math inline">\(f(x)\)</span> at a point <span class="math inline">\(x\)</span>. Here I chose <span class="math inline">\(dx = 10^{-5}\)</span>. The exact answer should be <span class="math inline">\(\frac{dy}{dx} = 2\)</span>. Notice how the error <span class="math inline">\(0.00001\)</span> is indeed of order <span class="math inline">\(dx\)</span>.</p>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> diff(f, x, dx<span class="op">=</span><span class="fl">1e-5</span>):</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    dy <span class="op">=</span> f(x <span class="op">+</span> dx) <span class="op">-</span> f(x)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dy <span class="op">/</span> dx</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: x <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>dydx <span class="op">=</span> diff(f, <span class="dv">1</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'dy/dx = </span><span class="sc">{</span>dydx<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>dy/dx = 2.00001000001393</code></pre>
</div>
</div>
<p>Calculating the derivative this way is called <strong>numerical differentiation</strong>. If you’re curious, it turns out you can improve the error in numerical differentiation calculations to order <span class="math inline">\(dx^2\)</span> by <em>centering</em> the difference estimate <span class="math inline">\(dy\)</span> symmetrically around <span class="math inline">\(x\)</span>. That is,</p>
<p><span class="math display">\[\frac{dy}{dx} = \frac{\frac{1}{2}\bigg(f\big(x+\frac{dx}{2}\big)-f\big(x-\frac{dx}{2}\big)\bigg)}{dx} + \mathcal{O}\big(dx^2\big).\]</span></p>
<p>Of course, the error goes to zero either way when <span class="math inline">\(dx\)</span> is infinitesimal. It’s only when calculating derivatives numerically that we’ve got to worry about errors.</p>
</section>
<section id="interpreting-derivatives" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="interpreting-derivatives"><span class="header-section-number">4.2.2</span> Interpreting Derivatives</h3>
<p>Since <span class="math inline">\(dy\)</span> is the change in <span class="math inline">\(y\)</span> in response to the change in <span class="math inline">\(x\)</span> by <span class="math inline">\(dx\)</span>, the derivative <span class="math inline">\(\frac{dy}{dx}\)</span> evidently represents some kind of a <em>rate</em>. It’s the rate that <span class="math inline">\(y\)</span> changes in response to small changes in <span class="math inline">\(x\)</span>.</p>
<p>Depending on what exactly <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> are we can think of the derivative as representing many different things. Here are some examples:</p>
<ul>
<li>If <span class="math inline">\(x\)</span> is the position of some particle and <span class="math inline">\(t\)</span> is time, <span class="math inline">\(\frac{dx}{dt}\)</span> represents the <em>speed</em> or <em>velocity</em> of that particle at time <span class="math inline">\(t\)</span>.</li>
<li>If <span class="math inline">\(p\)</span> is the pressure in the atmosphere at a height <span class="math inline">\(z\)</span> from the Earth’s surface, then <span class="math inline">\(\frac{dp}{dz}\)</span> represents the <em>pressure gradient</em>, a measure of how much pressure varies with altitude.</li>
<li>If <span class="math inline">\(q\)</span> is the quantity of some economic good and <span class="math inline">\(p\)</span> is the price of that good, then <span class="math inline">\(\frac{dq}{dp}\)</span> represents the <em>elasticity</em> of that good, i.e.&nbsp;how responsive the good’s quantity is to changes in its price.</li>
<li>If <span class="math inline">\(C\)</span> is the cost of some good and <span class="math inline">\(q\)</span> is the amount of that good we have, then <span class="math inline">\(\frac{dC}{dq}\)</span> represents the <em>marginal cost</em> of that good. It’s the amount we’d have to pay to get one more unit of that good.</li>
<li>If <span class="math inline">\(L\)</span> is the loss function of some machine learning algorithm and <span class="math inline">\(\theta\)</span> is some parameter of the model, then <span class="math inline">\(\frac{dL}{d\theta}\)</span> represents the <em>loss gradient</em>, a measure of how sensitive the loss is to changes in that particular parameter.</li>
</ul>
<p>The derivative also has a useful interpretation when thinking about a function graphically. It represents the <em>slope</em> of a function <span class="math inline">\(y=f(x)\)</span> at the point <span class="math inline">\(x\)</span>. This follows from the fact that</p>
<p><span class="math display">\[dy = \frac{dy}{dx} dx.\]</span></p>
<p>If we relax the requirement that <span class="math inline">\(dx\)</span> be infinitesimal, then it’s just the difference between two finite points, say <span class="math inline">\(dx = x - a\)</span>. That means <span class="math inline">\(dy\)</span> is also the difference between two points <span class="math inline">\(f(x) - f(a)\)</span>. If we plug these into the above formula and solve for <span class="math inline">\(f(x)\)</span>, we get</p>
<p><span class="math display">\[f(x) \approx f(a) + \frac{d}{dx} f(a) (x - a).\]</span></p>
<p>If we think of <span class="math inline">\(a\)</span> as some fixed point and <span class="math inline">\(x\)</span> as a variable, this is just the equation for a line. It’s a line passing through the point <span class="math inline">\((a, f(a))\)</span> with a slope <span class="math inline">\(\frac{d}{dx} f(a)\)</span>. This line is called the <strong>tangent line</strong> of the function at the point <span class="math inline">\(a\)</span>. To see why let’s do a quick example.</p>
<p>Suppose again that <span class="math inline">\(y=x^2\)</span>. If we take <span class="math inline">\(a=1\)</span>, then <span class="math inline">\(f(a) = 1\)</span> and <span class="math inline">\(\frac{d}{dx} f(a) = 2a = 2\)</span>, so we have an equation</p>
<p><span class="math display">\[y \approx 1 + 2(x - 1) = 2x - 1.\]</span></p>
<p>Let’s plot this line along with the function itself to see what’s going on. Notice the tangent line is hugging the function at the red point <span class="math inline">\(a=1, f(a)=1\)</span>, and that the slope of the line seems to hug the curve at that point. This is what it means to say that the derivative is the slope of a function at a point. It’s the slope of the tangent line passing through that point.</p>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: x <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>dfdx <span class="op">=</span> <span class="kw">lambda</span> x: <span class="dv">2</span> <span class="op">*</span> x</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="fl">0.1</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>f_line <span class="op">=</span> <span class="kw">lambda</span> x: f(a) <span class="op">+</span> dfdx(a) <span class="op">*</span> (x <span class="op">-</span> a)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>plot_function(x, [f, f_line], points<span class="op">=</span>[[a, f(a)]], xlim<span class="op">=</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>), ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>              title<span class="op">=</span><span class="ss">f'Tangent to $y=x^2$ at $a$=</span><span class="sc">{</span>a<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="calculus_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Notice a curious fact from this slope interpretation. At the minimum value of the function, in this case at <span class="math inline">\(x=0\)</span>, the slope is flat, which evidently implies that the derivative at the minimum is zero. We’ll exploit this fact in a future lesson when we talk about optimization.</p>
<p>Another way to interpret the equation</p>
<p><span class="math display">\[f(x) \approx f(a) + \frac{d}{dx} f(a) (x - a)\]</span></p>
<p>is that the right-hand side is the best linear approximation of the function at the point <span class="math inline">\(x=a\)</span>. Provided <span class="math inline">\(x \approx a\)</span>, we can well-approximate <span class="math inline">\(f(x)\)</span> by its tangent line. Another way of saying the same thing is that if we zoom in enough on the plot we can’t tell that the function isn’t linear.</p>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>plot_function(x, [f, f_line], points<span class="op">=</span>[[a, f(a)]], xlim<span class="op">=</span>(<span class="fl">0.7</span>, <span class="fl">1.3</span>), ylim<span class="op">=</span>(<span class="fl">0.7</span>, <span class="fl">1.3</span>),</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>              title<span class="op">=</span><span class="ss">f'$y=x^2$ near $a=1$'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="calculus_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="second-derivatives" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="second-derivatives"><span class="header-section-number">4.2.3</span> Second Derivatives</h3>
<p>Differentials and derivatives cover the situation when we’re interested in changes in a function that are <em>first-order</em> in <span class="math inline">\(dx\)</span>. But suppose we’re interested in changes that are <em>second-order</em> in <span class="math inline">\(dx\)</span>? This leads us to the notion of second differentials. If <span class="math inline">\(dx^2\)</span> is a second-order differential change in <span class="math inline">\(x\)</span>, then <span class="math inline">\(d^2y = d(dy)\)</span> is a second-order differential change in <span class="math inline">\(y=f(x)\)</span>. Using the fact that <span class="math inline">\(dy=f(x+dx)-f(x)\)</span>, it’s not too hard to show that</p>
<p><span class="math display">\[d^2 y  = f(x+dx)-2f(x)+f(x-dx).\]</span></p>
<p>The ratio of second differentials is called the <strong>second derivative</strong> of <span class="math inline">\(y\)</span> with respect to <span class="math inline">\(x\)</span>,</p>
<p><span class="math display">\[\frac{d^2 y}{dx^2} = \frac{f(x+dx)-2f(x)+f(x-dx)}{dx^2}.\]</span></p>
<p>As with the first derivative <span class="math inline">\(\frac{dy}{dx}\)</span>, this equality will only be exact when <span class="math inline">\(dx\)</span> is infinitesimal. Otherwise there will be an error of order <span class="math inline">\(dx^3\)</span>.</p>
<p>Let’s do a quick example. Consider again the cubic function <span class="math inline">\(y=x^3\)</span>. I already showed its first derivative is the function <span class="math inline">\(\frac{dy}{dx} = 3x^2\)</span>. Let’s see what its second derivative is. Evidently, for <span class="math inline">\(d^2y\)</span> we have</p>
<p><span class="math display">\[\begin{align*}
d^2 y &amp;= f(x+dx)-2f(x)+f(x-dx) \\
&amp;= (x+dx)^3 - 2x^3 + (x-dx)^3 \\
&amp;= (x^3 + 3x^2dx + 3xdx^2 + dx^3) - 2x^3 + (x^3 - 3x^2dx + 3xdx^2 - dx^3) \\
&amp;= 6xdx^2.
\end{align*}\]</span></p>
<p>Dividing both sides by <span class="math inline">\(dx^2\)</span>, the second derivative of <span class="math inline">\(y=x^3\)</span> is evidently just <span class="math inline">\(\frac{d^2 y}{dx^2} = 6x\)</span>. We can actually see this in a simpler way. Notice that</p>
<p><span class="math display">\[\frac{d^2 y}{dx^2} = \frac{d}{dx} \frac{dy}{dx}.\]</span></p>
<p>That is, it’s just the derivative of the derivative. Since we already knew <span class="math inline">\(dy = 3x^2dx\)</span> and <span class="math inline">\(d(x^2)=2xdx\)</span>, we could just have done</p>
<p><span class="math display">\[\begin{align*}
d^2 y = d(dy) &amp;= d(3x^2dx) \\
&amp;= 3d(x^2)dx \\
&amp;= 3(2xdx)dx \\
&amp;= 6xdx^2. \\
\end{align*}\]</span></p>
<p>Just like the first derivative is a function of <span class="math inline">\(x\)</span>, so is the second derivative. For this reason we’d also often write it as</p>
<p><span class="math display">\[\frac{d^2 y}{dx^2} = \frac{d^2}{dx^2} f(x) = f''(x).\]</span></p>
<p>We can calculate the second derivative numerically similar to the way we did the first derivative, by taking the ratio of <span class="math inline">\(d^2 y\)</span> with <span class="math inline">\(dx^2\)</span>. Again, we have to account for the fact that <span class="math inline">\(dx\)</span> won’t be infinitesimal, which means there will be an error term. In the case of the second derivative, the error term will be of order <span class="math inline">\(dx^2\)</span>,</p>
<p><span class="math display">\[\frac{d^2 y}{dx^2} = \frac{f(x+dx)-2f(x)+f(x-dx)}{dx^2} + \mathcal{O}(dx^2).\]</span></p>
<p>By using center differences like we did the first derivative we can get the error down to order <span class="math inline">\(dx^3\)</span>. Here’s a function to calculate the second derivative numerically. I’ll test it again on the quadratic <span class="math inline">\(y=x^2\)</span> at <span class="math inline">\(x=1\)</span>. The exact answer should be <span class="math inline">\(\frac{d^2 y}{dx^2} = 2\)</span>. Since I’m dividing this time by <span class="math inline">\(dx^2\)</span> I’ll use <span class="math inline">\(dx = 10^{-3}\)</span> to avoid worries about numerical roundoff. Evidently the error is about <span class="math inline">\(0.000002\)</span>, which is of order <span class="math inline">\(dx^2\)</span> as expected.</p>
<div class="cell" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> second_diff(f, x, dx<span class="op">=</span><span class="fl">1e-5</span>):</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    d2y <span class="op">=</span> f(x <span class="op">+</span> dx) <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> f(x) <span class="op">+</span> f(x <span class="op">-</span> dx)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d2y <span class="op">/</span> dx<span class="op">**</span><span class="dv">2</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: x <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>d2ydx2 <span class="op">=</span> second_diff(f, <span class="dv">1</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'd2y/dx2 = </span><span class="sc">{</span>d2ydx2<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>d2y/dx2 = 2.000002385926791</code></pre>
</div>
</div>
<p>To see how the second derivative arises we need to ask what happens if we want to approximate a function <span class="math inline">\(y=f(x)\)</span> not just with a line, but with a parabola. It turns out that if we want to approximate the function with a parabola about some point <span class="math inline">\(x=a\)</span> we’d use something like this,</p>
<p><span class="math display">\[f(x) \approx f(a) + \frac{d}{dx} f(a) (x - a) + \color{red}{\frac{1}{2} \frac{d^2}{dx^2} f(a) (x - a)^2}\color{black}.\]</span></p>
<p>The new term is shown in red. It’s quadratic in <span class="math inline">\(x-a\)</span> and proportional to the second derivative of <span class="math inline">\(y=f(x)\)</span> at the point <span class="math inline">\(a\)</span>. We can imagine writing it in a form</p>
<p><span class="math display">\[y = A(x-a)^2 + B(x-a) + C.\]</span></p>
<p>This gives the equation of a parabola with vertex at <span class="math inline">\(\big(a-\frac{B}{2A}, \big(a-\frac{B}{2A}\big)^2\big)\)</span>. Evidently, the <em>curvature</em> of the parabola is determined by the coefficient <span class="math inline">\(A = \frac{1}{2} \frac{d^2}{dx^2} f(a)\)</span>. This means that the second derivative is a measure of the function’s <em>curvature</em> around a point. The larger the second derivative is, the steeper the parabola at that point will be, and hence the steeper the function’s curvature will be around <span class="math inline">\(x=a\)</span>.</p>
<p>Here’s an example. Suppose we have the function <span class="math inline">\(y = x^3 + 5x^2\)</span>, and we wanted to approximate the function with a parabola about the point <span class="math inline">\(x=1\)</span>. The approximating parabola turns out to be</p>
<p><span class="math display">\[y = 8(x - 1)^2 + 13(x - 1) + 6.\]</span></p>
<p>The plot of the function and the approximating parabola is shown below.</p>
<div class="cell" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: x <span class="op">**</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">5</span> <span class="op">*</span> x <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>dfdx <span class="op">=</span> <span class="kw">lambda</span> x: <span class="dv">3</span> <span class="op">*</span> x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">10</span> <span class="op">*</span> x</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>d2fdx2 <span class="op">=</span> <span class="kw">lambda</span> x: <span class="dv">6</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">10</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">50</span>, <span class="dv">50</span>, <span class="fl">0.1</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>f_parabola <span class="op">=</span> <span class="kw">lambda</span> x: f(a) <span class="op">+</span> dfdx(a) <span class="op">*</span> (x <span class="op">-</span> a) <span class="op">+</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span> <span class="op">*</span> d2fdx2(a) <span class="op">*</span> (x <span class="op">-</span> a) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>plot_function(x, [f, f_parabola], points<span class="op">=</span>[[a, f(a)]], xlim<span class="op">=</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>), ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">100</span>),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>              title<span class="op">=</span><span class="ss">f''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="calculus_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>While this looks like a bad approximation when <span class="math inline">\(x\)</span> is far away from <span class="math inline">\(x=1\)</span>, especially if <span class="math inline">\(x\)</span> is negative, if we zoom in closer to <span class="math inline">\(x=1\)</span> we see that it actually does a very good job of approximating the function locally. In the range <span class="math inline">\([0.5, 1.5]\)</span> you can’t even really tell the function isn’t parabolic.</p>
<div class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>plot_function(x, [f, f_parabola], points<span class="op">=</span>[[a, f(a)]], xlim<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>), ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">30</span>),</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>              title<span class="op">=</span><span class="ss">f''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="calculus_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The sign of the second derivative at <span class="math inline">\(x=a\)</span> says something about which way the function is curving. If the second derivative is positive, the function is curving <em>upward</em> around <span class="math inline">\(x=a\)</span>. If the second derivative is negative, the function is curving <em>downward</em> at <span class="math inline">\(x=a\)</span>. In the edge case where the second derivative is zero you can’t tell. You have to go to higher order terms and look at the sign of those.</p>
<p>If we interpret the first derivative as some kind of <em>rate</em>, then we’d have to interpret the second derivative as a rate of a rate, or an <em>acceleration</em>. For example, if <span class="math inline">\(y\)</span> was the position of an object, then the first derivative <span class="math inline">\(\frac{dy}{dx}\)</span> would represent its speed or velocity, while the second derivative <span class="math inline">\(\frac{d^2y}{dx^2}\)</span> would represent the object’s acceleration at a given point in time.</p>
<p>There are higher-order differentials and derivatives as well. We can take third differentials, fourth differentials, and so on. Fortunately, these higher terms don’t really seem to show up in machine learning, so it’s not worth going into them.</p>
<p>I’ll just briefly mention a nice fact. For many functions in practice, we can keep doing the kind of approximation I’ve been doing indefinitely for higher and higher derivatives. If we take infinitely many terms we get what’s called the <strong>Taylor Series Expansion</strong> of <span class="math inline">\(y=f(x)\)</span> about <span class="math inline">\(x=a\)</span>,</p>
<p><span class="math display">\[f(x) = \sum_{n=0}^\infty \frac{1}{n!} \frac{d^n}{dx^n} f(a) (x-a)^n = f(a) + \frac{d}{dx} f(a) (x - a) + \frac{1}{2} \frac{d^2}{dx^2} f(a) (x - a)^2 + \frac{1}{6} \frac{d^3}{dx^3} f(a) (x - a)^3 + \cdots\]</span></p>
<p>By taking more and more terms in the Taylor Series we can get a better and better approximation of a function about a point <span class="math inline">\(x=a\)</span> by using higher and higher degree polynomials. Note that when infinitely many terms are used the equality becomes exact. It’s only approximate if we ignore higher-order terms.</p>
</section>
<section id="differentiation-rules" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="differentiation-rules"><span class="header-section-number">4.2.4</span> Differentiation Rules</h3>
<p>It would be useful to have a systematic way to calculate differentials and derivatives without having to go back to the definition each time or always do it numerically. In this section I’ll show some rules that makes this kind of thing much easier.</p>
<p>To start with, I’ll list the differentials and derivatives of some common functions. I won’t torture you by deriving all of these one-by-one.</p>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 30%">
<col style="width: 36%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Function</strong></td>
<td style="text-align: left;"><strong>Differential</strong></td>
<td style="text-align: left;"><strong>Derivative</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(y = 0\)</span></td>
<td style="text-align: left;"><span class="math inline">\(dy = 0\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{dy}{dx} = 0\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(y = 1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(dy = 0\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{dy}{dx} = 0\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(y = x\)</span></td>
<td style="text-align: left;"><span class="math inline">\(dy = dx\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{dy}{dx} = 1\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(y = x^n\)</span></td>
<td style="text-align: left;"><span class="math inline">\(dy = nx^{n-1}dx\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{dy}{dx} = nx^{n-1}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(y = \sqrt{x}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(dy = \frac{dx}{2\sqrt{x}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{dy}{dx} = \frac{1}{2\sqrt{x}}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(y = \frac{1}{x}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(dy = -\frac{dx}{x^2}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{dy}{dx} = -\frac{1}{x^2}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(y = e^x\)</span></td>
<td style="text-align: left;"><span class="math inline">\(dy = e^xdx\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{dy}{dx} = e^x\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(y = \log{x}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(dy = \frac{dx}{x}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{dy}{dx} = \frac{1}{x}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(y = \sin{x}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(dy = \cos{x}dx\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{dy}{dx} = \cos{x}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(y = \cos{x}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(dy = -\sin{x}dx\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{dy}{dx} = -\sin{x}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(y = \sigma(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(dy = \sigma(x)\big(1-\sigma(x)\big)dx\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{dy}{dx} = \sigma(x)\big(1-\sigma(x)\big)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(y = \tanh(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(dy = \big(1 - \tanh^2(x)\big)dx\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{dy}{dx} = 1 - \tanh^2(x)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(y = \text{ReLU}(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(dy = u(x)dx = [x \geq 0]dx\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{dy}{dx} = u(x) = [x \geq 0]\)</span></td>
</tr>
</tbody>
</table>
<p>Let’s now look at some general rules for differentials and derivatives. The most fundamental rule is that these things are <em>linear</em>. That is, if <span class="math inline">\(a, b\)</span> are constant real numbers and <span class="math inline">\(u, v\)</span> are functions,</p>
<p><span class="math display">\[d(au + bv) = adu + bdv, \quad \text{and} \quad \frac{d(au+bv)}{dx} = a \frac{du}{dx} + b \frac{dv}{dx}.\]</span></p>
<p>It’s pretty easy to see this. Suppose <span class="math inline">\(f(x) = au(x) + bv(x)\)</span>. Then we’d have</p>
<p><span class="math display">\[\begin{align*}
d(au + bv) &amp;= f(x + dx) - f(x) \\
&amp;= \big(au(x+dx) + bv(x+dx)\big) - \big(au(x) + bv(x)\big) \\
&amp;= a \big(u(x+dx) - u(x) \big) + b \big(v(x+dx) - v(x) \big) \\
&amp;= adu + bdv.
\end{align*}\]</span></p>
<p>For example, that if we have the function <span class="math inline">\(y = 5\sin x + 10x^2 - 4\)</span>, then we can write</p>
<p><span class="math display">\[dy = d(5\sin x + 10x^2 - 4) = 5d(\sin x) + 10d(x^2) - 4d(1) = 5\cos x dx + 20xdx + 0dx,\]</span></p>
<p>or dividing both sides by <span class="math inline">\(dx\)</span>,</p>
<p><span class="math display">\[\frac{dy}{dx} = 5\cos x + 20x.\]</span></p>
<p>If we wanted, we could take the second derivative just as easily,</p>
<p><span class="math display">\[d^2y = d(5\cos x \cdot dx + 20xdx) = 5dx \cdot d(\cos x) + 20dx^2 = -5\sin x \cdot dx^2 + 20 dx^2,\]</span></p>
<p>which means</p>
<p><span class="math display">\[\frac{d^2y}{dx^2} = -5\sin x + 20.\]</span></p>
<p>Sympy can do all this for you. You’ll first need to define a variable <code>x</code>, then define <code>y</code> as a function of <code>x</code>. Once you’ve done this, you can get the first derivative with <code>y.diff(x)</code>, and the second derivative with <code>y.diff(x).diff(x)</code>.</p>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">5</span> <span class="op">*</span> sp.sin(x) <span class="op">+</span> <span class="dv">10</span> <span class="op">*</span> x <span class="op">**</span> <span class="dv">2</span>  <span class="op">-</span> <span class="dv">4</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>dydx <span class="op">=</span> y.diff(x)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>d2dx2 <span class="op">=</span> y.diff(x).diff(x)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'y = </span><span class="sc">{</span>y<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'dy/dx = </span><span class="sc">{</span>dydx<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'd2y/dx2 = </span><span class="sc">{</span>d2dx2<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>y = 10*x**2 + 5*sin(x) - 4
dy/dx = 20*x + 5*cos(x)
d2y/dx2 = 20 - 5*sin(x)</code></pre>
</div>
</div>
<p>Here’s a more interesting example that shows we can take differentials of any equation. It need not even be a single-valued function <span class="math inline">\(y=f(x)\)</span>. Any function of the form <span class="math inline">\(g(x,y)=0\)</span> will do. Suppose we have the equation <span class="math inline">\(x^2+y^2=1\)</span>. This is the equation for a circle of radius 1. Taking the differential of both sides and solving for <span class="math inline">\(dy\)</span>, we have</p>
<p><span class="math display">\[\begin{align*}
d(x^2 + y^2) &amp;= d(1) \\
d(x^2) + d(y^2) &amp;= 0 \\
2xdx + 2ydy &amp;= 0 \\
dy &amp;= -\frac{x}{y}dx.
\end{align*}\]</span></p>
<p>Evidently the slope of a circle changes like <span class="math inline">\(\frac{dy}{dx} = -\frac{x}{y}\)</span>. Since the differential of a constant is always zero, this will be true for a circle of <em>any</em> radius.</p>
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> <span class="kw">lambda</span> x: np.sqrt(<span class="dv">1</span> <span class="op">-</span> x <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>f2 <span class="op">=</span> <span class="kw">lambda</span> x: <span class="op">-</span>np.sqrt(<span class="dv">1</span> <span class="op">-</span> x <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>dfdx1 <span class="op">=</span> <span class="kw">lambda</span> x: <span class="op">-</span>x <span class="op">/</span> f1(x)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>dfdx2 <span class="op">=</span> <span class="kw">lambda</span> x: <span class="op">-</span>x <span class="op">/</span> f2(x)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>ya <span class="op">=</span> f1(a)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.001</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> ya <span class="op">&gt;=</span> <span class="dv">0</span>:</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    f_line <span class="op">=</span> <span class="kw">lambda</span> x: ya <span class="op">+</span> dfdx1(a) <span class="op">*</span> (x <span class="op">-</span> a)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    f_line <span class="op">=</span> <span class="kw">lambda</span> x: ya <span class="op">+</span> dfdx2(a) <span class="op">*</span> (x <span class="op">-</span> a)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>plot_function(x, [f1, f2, f_line], points<span class="op">=</span>[[a, ya]], xlim<span class="op">=</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>), ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>              colors<span class="op">=</span>[<span class="st">'steelblue'</span>, <span class="st">'steelblue'</span>, <span class="st">'orange'</span>], </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>              title<span class="op">=</span><span class="ss">f'Tangent to $x^2+y^2=1$ at (</span><span class="sc">{</span><span class="bu">round</span>(a, <span class="dv">3</span>)<span class="sc">}</span><span class="ss">,</span><span class="sc">{</span><span class="bu">round</span>(ya, <span class="dv">3</span>)<span class="sc">}</span><span class="ss">)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="calculus_files/figure-html/cell-22-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Another useful rule that differentials and derivatives follow is the <strong>product rule</strong>. If <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> are two functions, then the differential of their product <span class="math inline">\(y=uv\)</span> is</p>
<p><span class="math display">\[d(uv) = udv + vdu.\]</span></p>
<p>It’s pretty easy to see that this is true as well. If we nudge <span class="math inline">\(y\)</span> a little bit to <span class="math inline">\(y+dy\)</span>, then we necessarily must nudge <span class="math inline">\(u\)</span> to some <span class="math inline">\(u+du\)</span> and <span class="math inline">\(v\)</span> to some <span class="math inline">\(v+dv\)</span>. This means we have</p>
<p><span class="math display">\[\begin{align*}
dy = d(uv) &amp;=  (u+du)(v+dv) - uv \\
&amp;=  (uv + udv + vdu + dudv) - uv \\
&amp;\approx  udv + vdu, \\
\end{align*}\]</span></p>
<p>where the last step follows provided <span class="math inline">\(dudv \approx 0\)</span>, which will be true if both <span class="math inline">\(du\)</span> and <span class="math inline">\(dv\)</span> are infinitesimal. Dividing both sides by <span class="math inline">\(dx\)</span> gives the derivative equivalent,</p>
<p><span class="math display">\[\frac{d(uv)}{dx} = u\frac{dv}{dx} + v\frac{du}{dx}.\]</span></p>
<p>As an example, suppose we had the function <span class="math inline">\(y=x^2e^x\)</span>. Setting <span class="math inline">\(u=x^2\)</span> and <span class="math inline">\(v=e^x\)</span>, we’d have</p>
<p><span class="math display">\[dy = d(uv) = udv + vdu = x^2 d(e^x) + e^x d(x^2) = x^2 e^x dx + 2xe^x dx.\]</span></p>
<p>Dividing both sides by <span class="math inline">\(dx\)</span> then gives the derivative, <span class="math inline">\(\frac{dy}{dx} = x^2 e^x + 2xe^x\)</span>.</p>
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x <span class="op">**</span> <span class="dv">2</span> <span class="op">*</span> sp.exp(x)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>dydx <span class="op">=</span> y.diff(x)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'y = </span><span class="sc">{</span>y<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'dy/dx = </span><span class="sc">{</span>dydx<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>y = x**2*exp(x)
dy/dx = x**2*exp(x) + 2*x*exp(x)</code></pre>
</div>
</div>
<p>Suppose we have a function <span class="math inline">\(y=\frac{u}{v}\)</span> that’s a quotient of two functions <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span>. To find <span class="math inline">\(dy\)</span>, can write this as <span class="math inline">\(y=uv^{-1}\)</span> and use the product rule,</p>
<p><span class="math display">\[dy = d(uv^{-1}) = ud(v^{-1}) + v^{-1}du = -\frac{udv}{v^2} + \frac{du}{v} = \frac{vdu - udv}{v^2}.\]</span></p>
<p>This is called the <strong>quotient rule</strong>,</p>
<p><span class="math display">\[d\bigg(\frac{u}{v}\bigg) = \frac{vdu - udv}{v^2}.\]</span></p>
<p>Again, dividing both sides by <span class="math inline">\(dx\)</span> gives the quotient rule for derivatives,</p>
<p><span class="math display">\[\frac{dy}{dx} = \frac{v\frac{du}{dx} - u\frac{dv}{dx}}{v^2}.\]</span></p>
<p>As an example, suppose we wanted to differentiate <span class="math inline">\(y=\frac{12e^x + 1}{x^2 + 1}\)</span>. Taking <span class="math inline">\(u=12e^x + 1\)</span> and <span class="math inline">\(v=x^2 + 1\)</span>, we’d have</p>
<p><span class="math display">\[dy = \frac{vdu - udv}{v^2} = \frac{(x^2 + 1)d(12e^x + 1) - (12e^x + 1)d(x^2 + 1)}{(x^2 + 1)^2} = \frac{12e^x(x^2 + 1)dx - 2x(12e^x + 1)dx}{(x^2 + 1)^2}.\]</span></p>
<p>Or dividing both sides by <span class="math inline">\(dx\)</span>,</p>
<p><span class="math display">\[\frac{dy}{dx} = \frac{12e^x(x^2 + 1) - 2x(12e^x + 1)}{(x^2 + 1)^2}.\]</span></p>
<div class="cell" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> (<span class="dv">12</span> <span class="op">*</span> sp.exp(x) <span class="op">+</span> <span class="dv">1</span>) <span class="op">/</span> (x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>dydx <span class="op">=</span> y.diff(x)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'y = </span><span class="sc">{</span>y<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'dy/dx = </span><span class="sc">{</span>dydx<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>y = (12*exp(x) + 1)/(x**2 + 1)
dy/dx = -2*x*(12*exp(x) + 1)/(x**2 + 1)**2 + 12*exp(x)/(x**2 + 1)</code></pre>
</div>
</div>
<p>The last rule I’ll mention is by far the most important one to know for machine learning purposes. It’s called the <strong>chain rule</strong>. Suppose we had a composite function <span class="math inline">\(y = f(g(x))\)</span>, or equivalently <span class="math inline">\(y=g(z)\)</span> and <span class="math inline">\(z=f(x)\)</span>. Then taking differentials we’d get</p>
<p><span class="math display">\[dy = \frac{dy}{dz} dz = \frac{dy}{dz} \frac{dz}{dx} dx.\]</span></p>
<p>Dividing both sides by <span class="math inline">\(dx\)</span> gives the derivative version,</p>
<p><span class="math display">\[\frac{dy}{dx} = \frac{dy}{dz} \frac{dz}{dx}.\]</span></p>
<p>The notation makes this look trivial since it seems like all we’re doing is multiplying and dividing by <span class="math inline">\(dz\)</span>. But the chain rule is a pretty deep fact. It says if we have a complicated function we can always break it up into easier composite functions, differentiate those, then multiply the results together.</p>
<p>Here’s an example. Suppose we had a function <span class="math inline">\(y = e^{-\frac{1}{2} x^2}\)</span>. This looks pretty complicated but it’s not. Notice we can think about this as a composition of the form <span class="math inline">\(y = e^z\)</span> where <span class="math inline">\(z = -\frac{1}{2} x^2\)</span>. Differentiating each of these on their is easy,</p>
<p><span class="math display">\[\begin{align*}
dy &amp;= d(e^z) = e^z dz, \\
dz &amp;= d\bigg(-\frac{1}{2} x^2\bigg) = -xdx. \\
\end{align*}\]</span></p>
<p>If we want to differentiate <span class="math inline">\(y\)</span> with respect to <span class="math inline">\(x\)</span> we just need to multiply these two together and substitute in for <span class="math inline">\(z\)</span>,</p>
<p><span class="math display">\[dy = \frac{dy}{dz} \frac{dz}{dx} dx = e^z (-x) dx = -x e^{-\frac{1}{2} x^2} dx,\]</span></p>
<p>or again dividing both sides by <span class="math inline">\(dx\)</span>,</p>
<p><span class="math display">\[\frac{dy}{dx} = -x e^{-\frac{1}{2} x^2}.\]</span></p>
<div class="cell" data-execution_count="24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> sp.exp(<span class="op">-</span>sp.Rational(<span class="dv">1</span>, <span class="dv">2</span>) <span class="op">*</span> x <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>dydx <span class="op">=</span> y.diff(x)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'y = </span><span class="sc">{</span>y<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'dy/dx = </span><span class="sc">{</span>dydx<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>y = exp(-x**2/2)
dy/dx = -x*exp(-x**2/2)</code></pre>
</div>
</div>
<p>What really makes the chain rule powerful for machine learning is that we can use it on arbitrarily many composition chains. For example, if we have a composition of three functions <span class="math inline">\(y=f(u)\)</span>, <span class="math inline">\(u=g(z)\)</span>, <span class="math inline">\(z=h(x)\)</span>, we’d have</p>
<p><span class="math display">\[\frac{dy}{dx} = \frac{dy}{du} \frac{du}{dz} \frac{dz}{dx}.\]</span></p>
<p>More generally, if we had a complicated function of <span class="math inline">\(n\)</span> compositions</p>
<p><span class="math display">\[\begin{align*}
y_0 &amp;= x, \\
y_1 &amp;= f_1(y_0), \\
y_2 &amp;= f_2(y_1), \\
\vdots &amp; \qquad \vdots \\
y_n &amp;= f_n(y_{n-1}), \\
y &amp;= y_n, \\
\end{align*}\]</span></p>
<p>the chain rule would say</p>
<p><span class="math display">\[\frac{dy}{dx} = \prod_{i=1}^n \frac{dy_i}{dy_{i-1}} = \frac{dy}{dy_{n-1}} \frac{dy_{n-1}}{dy_{n-2}} \cdots \frac{dy_2}{dy_1} \frac{dy_1}{dx}.\]</span></p>
<p>The last rule I’ll mention is a method to calculate the derivative of an inverse function. Suppose <span class="math inline">\(y=f(x)\)</span>. If the function is invertible, we can solve for <span class="math inline">\(x\)</span> and get an inverse function <span class="math inline">\(x = f^{-1}(y)\)</span>. The inverse rule says if we know the derivative of one of these we can easily get the derivative of the other by inverting it,</p>
<p><span class="math display">\[\frac{dx}{dy} = \frac{1}{\frac{dy}{dx}}.\]</span></p>
<p>Again, the notation makes this look pretty trivial. What’s not said is that in going from one to the other we have to be careful what’s a function of what. On the left-hand side, <span class="math inline">\(x\)</span> is a function of <span class="math inline">\(y\)</span>, but on the right-hand side <span class="math inline">\(y\)</span> is a function of <span class="math inline">\(x\)</span>.</p>
<p>For example, suppose we had the function <span class="math inline">\(y=e^x\)</span> and for some reason wanted to know <span class="math inline">\(\frac{dx}{dy}\)</span>. What we can do is calculate <span class="math inline">\(\frac{dy}{dx} = e^x\)</span>, and invert it to get <span class="math inline">\(\frac{dx}{dy}\)</span>,</p>
<p><span class="math display">\[\frac{dx}{dy} = \frac{1}{\frac{dy}{dx}} = \frac{1}{e^x} = \frac{1}{y}.\]</span></p>
<p>Of course, this is just the derivative of the logarithm function <span class="math inline">\(x = \log y\)</span>, which makes sense since <span class="math inline">\(x=\log y\)</span> is the inverse of <span class="math inline">\(y=e^x\)</span>.</p>
<p>Here’s a summary table of all these rules for reference. I’ll state them in derivative form and provide an example of each one for later reference.</p>
<table class="table">
<colgroup>
<col style="width: 30%">
<col style="width: 30%">
<col style="width: 39%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Name</strong></td>
<td style="text-align: left;"><strong>Rule</strong></td>
<td style="text-align: left;"><strong>Example</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Linearity</td>
<td style="text-align: left;"><span class="math inline">\(\frac{d}{dx}(au + bv) = a\frac{du}{dx} + b\frac{dv}{dx}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{d}{dx}(2x^2 + 5\log x) = 2\frac{d}{dx}x^2 + 5\frac{d}{dx}\log x = 4x + \frac{5}{x}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Product Rule</td>
<td style="text-align: left;"><span class="math inline">\(\frac{d}{dx}(uv)=u\frac{dv}{dx} + v\frac{du}{dx}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{d}{dx}(x e^x) = x \frac{d}{dx}e^x + e^x \frac{d}{dx} x = xe^x + e^x\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Quotient Rule</td>
<td style="text-align: left;"><span class="math inline">\(\frac{d}{dx}\big(\frac{u}{v}\big) = \frac{v\frac{du}{dx}-u\frac{dv}{dx}}{v^2}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{d}{dx} \frac{\cos x}{x^2} = \frac{x^2\frac{d}{dx}\cos x-\cos x\frac{d}{dx}x^2}{(x^2)^2} = \frac{-x^2 \sin x - 2x \cos x}{x^4}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chain Rule</td>
<td style="text-align: left;"><span class="math inline">\(\frac{dy}{dx} = \frac{dy}{dz}\frac{dz}{dx}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{d}{dx} e^{\sin x} = \frac{d}{dy} e^y \frac{d}{dx}\sin x = e^{\sin x} \cos x\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Inverse Rule</td>
<td style="text-align: left;"><span class="math inline">\(\frac{dx}{dy} = \big(\frac{dy}{dx}\big)^{-1}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y = 5x + 1 \quad \Longrightarrow \quad \frac{dx}{dy} = \big(\frac{dy}{dx}\big)^{-1} = \frac{1}{5}\)</span></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="integral-calculus" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="integral-calculus"><span class="header-section-number">4.3</span> Integral Calculus</h2>
<p>By far, differential calculus is the most important area of calculus to know for machine learning purposes. The main reason for this is that in machine learning we seek to train models by optimizing functions, and (as I’ll cover in a future lesson) optimization is all about taking derivatives.</p>
<p>Nevertheless, integral calculus is the giant other half of calculus, so I owe it to at least briefly cover the subject. Knowing a little about integration will also make it easier to understand the later lessons on probability theory and distributions.</p>
<p>We can think about integral calculus in two distinct ways that turn out to be linked together by an important theorem. One way of thinking about an integral is as an inverse operation that undoes differentiation. The other way of thinking about an integral is as sum of a bunch of infinitesimal segments.</p>
<section id="indefinite-integration" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="indefinite-integration"><span class="header-section-number">4.3.1</span> Indefinite Integration</h3>
<p>Suppose we knew that some function <span class="math inline">\(F(x)\)</span> had a derivative of <span class="math inline">\(f(x)\)</span>, i.e.</p>
<p><span class="math display">\[f(x) = \frac{d}{dx} F(x).\]</span></p>
<p>If we only knew <span class="math inline">\(f(x)\)</span>, how would we go about “undoing” the differentiation to get back <span class="math inline">\(F(x)\)</span>? Essentially what we’d need to do is work backward.</p>
<p>For example, suppose we knew <span class="math inline">\(f(x)=x\)</span>. How could we find <span class="math inline">\(F(x)\)</span>? Well, we already know that <span class="math inline">\(\frac{d}{dx} x^2 = 2x\)</span>. If we divide both sides of this equation by <span class="math inline">\(2\)</span> we’ve evidently got <span class="math inline">\(F(x)\)</span>, i.e.&nbsp;<span class="math inline">\(F(x) = \frac{1}{2} x^2\)</span>. Strictly speaking, this is only <em>one</em> possible solution. We could add any constant to <span class="math inline">\(F(x)\)</span> and not change the answer since the derivative of a constant is zero.</p>
<p>The function <span class="math inline">\(F(x)\)</span> is called the <strong>indefinite integral</strong> of <span class="math inline">\(f(x)\)</span>. In textbooks it’s sometimes also called an <em>antiderivative</em> since it undoes the derivative operation. For reasons I’ll explain soon, we usually write the indefinite integral using a funny notation,</p>
<p><span class="math display">\[F(x) = \int f(x) dx.\]</span></p>
<p>For example, if <span class="math inline">\(f(x) = x\)</span>, we’d write</p>
<p><span class="math display">\[\int x dx = \frac{1}{2} x^2.\]</span></p>
<p>The function on the right is the <span class="math inline">\(F(x)=\frac{1}{2} x^2\)</span> that undoes the function inside the integral, namely <span class="math inline">\(f(x)=x\)</span>.</p>
<p>As far as interpreting what an indefinite integral is, if you think of <span class="math inline">\(f(x)\)</span> as the rate of some thing, then <span class="math inline">\(F(x)\)</span> tells you the aggregate total of that thing. For example, if <span class="math inline">\(f(x)\)</span> was the speed of an object as a function of time, then its integral <span class="math inline">\(F(x)\)</span> would tell you how far that object has moved as a function of time. If <span class="math inline">\(f(x)\)</span> was the demand of some good as a function of price, then <span class="math inline">\(F(x)\)</span> would be the <em>consumer surplus</em> of that good, or how much consumers benefit from being able to buy that good for cheaper than they were willing to pay.</p>
<p>We could go through and figure out what the indefinite integral is one-by-one for the common functions we’ve seen so far, but I’ll spare you the detail. They’re given in the table below.</p>
<table class="table">
<colgroup>
<col style="width: 48%">
<col style="width: 51%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Function</strong></td>
<td style="text-align: left;"><strong>Integral</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(y = 0\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\int y dx = 0\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(y = 1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\int y dx = x\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(y = x\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\int y dx = \frac{1}{2}x^2\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(y = \sqrt{x}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\int y dx = \frac{2}{3} x^{3/2}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(y = \frac{1}{x}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\int y dx = \log{x}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(y = x^n\)</span> where <span class="math inline">\(n \neq -1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\int y dx = \frac{1}{n+1}x^{n+1}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(y = e^x\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\int y dx = e^x\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(y = \log{x}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\int y dx = x \log{x} - x\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(y = \sin{x}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\int y dx = -\cos{x}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(y = \cos{x}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\int y dx = \sin{x}\)</span></td>
</tr>
</tbody>
</table>
<p>By construction, the indefinite integral is the inverse operation of the derivative operation. This means they cancel each other,</p>
<p><span class="math display">\[d\bigg(\int f(x) dx\bigg) = f(x) dx, \quad \text{and} \quad \int dF(x) = \int \frac{d}{dx} F(x) dx = F(x).\]</span></p>
<p>This fact is sometimes called the <strong>Leibniz Rule</strong>. It means that the indefinite integral inherits many of the properties of the derivative. Most importantly, it’s <em>linear</em>. If <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are constants, and <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> are two functions, then</p>
<p><span class="math display">\[\int \big(au + bv\big) dx = a \int u dx + b \int v dx.\]</span></p>
<p>For example, if <span class="math inline">\(y = -x^3 + 7\sin x\)</span>, we’d have</p>
<p><span class="math display">\[\int y dx = \int (-x^3 + 7\sin x) dx = - \int x^3 dx + 6 \int \sin x dx = -\frac{1}{4} x^4 - 6 \cos x.\]</span></p>
<p>Again, you could technically add a constant to this answer and not change the result, but it’s not typical to do this, at least outside of calculus textbooks.</p>
<p>As with differentiation, sympy can calculate these things for you. Just define <code>x</code> and <code>y</code>, then calculate the indefinite integral with <code>y.integrate(x)</code>.</p>
<div class="cell" data-execution_count="25">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="op">-</span>x <span class="op">**</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">*</span> sp.sin(x)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>int_y <span class="op">=</span> y.integrate(x)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'y = </span><span class="sc">{</span>y<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'int y dx = </span><span class="sc">{</span>int_y<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>y = -x**3 + 7*sin(x)
int y dx = -x**4/4 - 7*cos(x)</code></pre>
</div>
</div>
<p>The integral version of the product rule is called <strong>integration by parts</strong>. If we start with the product rule,</p>
<p><span class="math display">\[d(uv) = udv + vdu,\]</span></p>
<p>and integrate both sides, we get</p>
<p><span class="math display">\[\int d(uv) = \int udv + \int vdu.\]</span></p>
<p>Since <span class="math inline">\(uv = \int d(uv)\)</span>, we can re-arrange terms to get the rule for integration by parts,</p>
<p><span class="math display">\[\int u dv = uv - \int v du.\]</span></p>
<p>Actually using integration by parts to calculate things isn’t often as straight forward as the product rule. To make integration by parts work in practice, you want to try to choose <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> so the right-hand side is easier to integrate than the left-hand side.</p>
<p>As a quick example, suppose we wanted to integrate <span class="math inline">\(y = x e^x\)</span>. What we could do is take <span class="math inline">\(u = x\)</span> and <span class="math inline">\(v=e^x\)</span>, so <span class="math inline">\(du=dx\)</span> and <span class="math inline">\(dv = e^x dx\)</span>. Then we’d have</p>
<p><span class="math display">\[\int x e^x dx = x e^x - \int e^x dx = x e^x - e^x.\]</span></p>
<div class="cell" data-execution_count="26">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x <span class="op">*</span> sp.exp(x)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>int_y <span class="op">=</span> y.integrate(x)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'y = </span><span class="sc">{</span>y<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'int y dx = </span><span class="sc">{</span>int_y<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>y = x*exp(x)
int y dx = (x - 1)*exp(x)</code></pre>
</div>
</div>
<p>Though less widely known and rarely covered in textbooks for some reason, there’s also an integration by parts for the quotient rule. Using the quotient rule</p>
<p><span class="math display">\[d\bigg( \frac{u}{v} \bigg) = \frac{vdu - udv}{v^2},\]</span></p>
<p>and integrating both sides, we get</p>
<p><span class="math display">\[\int d\bigg( \frac{u}{v} \bigg) = \int \frac{vdu - udv}{v^2} = \int \frac{1}{v}du + \int \frac{u}{v^2}dv.\]</span></p>
<p>Since <span class="math inline">\(\frac{u}{v} = \int d\big(\frac{u}{v}\big)\)</span> we can again rearrange terms to get</p>
<p><span class="math display">\[\int \frac{1}{v} du = \frac{u}{v} + \int \frac{u}{v^2} du.\]</span></p>
<p>Just as with the product integration by parts, using this in practice often involves reducing a complicated integral on the left-hand side to a less complicated integral on the right-hand side.</p>
<p>The integral version of the <em>chain rule</em> is called <strong>change of variables</strong> or <strong>substitution</strong>. Suppose we had a function <span class="math inline">\(y=f(x)\)</span> and wanted to integrate it. One thing we could do is make a change of variable by letting <span class="math inline">\(x\)</span> be a function of some other variable <span class="math inline">\(u\)</span>, say <span class="math inline">\(x = g(u)\)</span>. If we multiply and divide <span class="math inline">\(f(x)dx\)</span> by <span class="math inline">\(du\)</span>, then</p>
<p><span class="math display">\[f(x) dx = f(g(u)) \frac{dx}{du} du.\]</span></p>
<p>Integrating both sides gives the change of variables formula,</p>
<p><span class="math display">\[\int f(x) dx = \int f(g(u)) \frac{dx}{du} du.\]</span></p>
<p>The left-hand side is integrated with respect to <span class="math inline">\(x\)</span>, while the right-hand side is integrated with respect to <span class="math inline">\(u\)</span>. Just like with integration by parts, using the change of variables formula in practice is more an art than a science. The tricky part is figuring out what <span class="math inline">\(x=g(u)\)</span> should be to make the integral easier to compute.</p>
<p>For example, suppose we wanted to integrate the function <span class="math inline">\(y = x e^{x^2}\)</span>. What we could do is let <span class="math inline">\(u=x^2\)</span>. Then <span class="math inline">\(du=2xdx\)</span>, and so we’d have</p>
<p><span class="math display">\[\int x e^{x^2} dx = \int x e^{u} \frac{1}{2x} du = \frac{1}{2} \int e^u du = \frac{1}{2} e^u = \frac{1}{2} e^{x^2}.\]</span></p>
<div class="cell" data-execution_count="27">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x <span class="op">*</span> sp.exp(x <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>int_y <span class="op">=</span> y.integrate(x)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'y = </span><span class="sc">{</span>y<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'int y dx = </span><span class="sc">{</span>int_y<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>y = x*exp(x**2)
int y dx = exp(x**2)/2</code></pre>
</div>
</div>
<p>Here’s a summary table of the integral rules I’ve covered so far.</p>
<table class="table">
<colgroup>
<col style="width: 30%">
<col style="width: 30%">
<col style="width: 39%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Name</strong></td>
<td style="text-align: left;"><strong>Rule</strong></td>
<td style="text-align: left;"><strong>Example</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Leibniz Rule</td>
<td style="text-align: left;"><span class="math inline">\(\frac{d}{dx} \int y dx = y\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{d}{dx} \int \sin t dt = \sin x\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Linear Rule</td>
<td style="text-align: left;"><span class="math inline">\(\int (au + bv) dx = a\int u dx + b\int v dx\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\int (-1 + 5e^x) dx = -\int 1 dx + 5\int e^x dx = -x + 5e^x\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Integration By Parts (product version)</td>
<td style="text-align: left;"><span class="math inline">\(\int u dv = uv - \int v du\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\int x e^x dx = \int x d(e^x) = x e^x - \int e^x dx = x e^x - e^x\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Integration By Parts (quotient version)</td>
<td style="text-align: left;"><span class="math inline">\(\int \frac{1}{v} du = \frac{u}{v} + \int \frac{u}{v^2} dv\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\int \frac{\sin \sqrt{x}}{x^2} dx = \frac{2\cos x^{-1/2}}{x^{1/2}} + \int x^{3/2} \cos x^{-1/2}dx = \frac{2\cos x^{-1/2}}{x^{1/2}} - 2 \sin x^{-1/2}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Change of Variables</td>
<td style="text-align: left;"><span class="math inline">\(\int f(x) dx = \int f(g(u)) \frac{dx}{du} dx\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\int x e^{x^2} dx = \int e^{x^2} d\big(\frac{1}{2}x^2\big) = \frac{1}{2} \int e^u du = \frac{1}{2} e^u = \frac{1}{2} e^{x^2}\)</span></td>
</tr>
</tbody>
</table>
<p>Before moving on, I’ll mention an important fact. While we can always take the derivative of a function and get a symbolic answer in terms of functions we’re used to, this is not always possible with integrals. In fact, most integrals we can write down we can’t evaluate using the methods covered here. There’s no way to find an explicit <span class="math inline">\(F(x)\)</span> whose derivative is <span class="math inline">\(f(x)\)</span> in terms of simple functions. A classic example of this is the Gaussian function</p>
<p><span class="math display">\[y = e^{-x^2}.\]</span></p>
<p>There’s no way you’d be able to integrate this symbolically and get a closed form solution in terms of simple functions. Unfortunately, this is the rule, not the exception. This fact often makes integration a lot harder than differentiation in practice. Fortunately, we can always evaluate an integral numerically, but I’ll need to discuss the definite integral first so we can understand what that even means.</p>
</section>
<section id="definite-integration" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="definite-integration"><span class="header-section-number">4.3.2</span> Definite Integration</h3>
<p>I said that integral calculus essentially consists of two things, finding functions that undo a derivative, and summing up infinitesimals. The first part I just covered, the indefinite integral. I’ll now discuss the second part, and how it can be linked with the definite integral via the Fundamental Theorem of Calculus.</p>
<p>Suppose now we had a function <span class="math inline">\(y=f(x)\)</span> and we wanted to compute the area under this curve between two endpoints <span class="math inline">\(x=a\)</span> and <span class="math inline">\(x=b\)</span>. So we have a working example, suppose the function is <span class="math inline">\(y=\sqrt{x}\)</span> and we want to find the area under its curve from <span class="math inline">\(x=0\)</span> to <span class="math inline">\(x=10\)</span>.</p>
<div class="cell" data-execution_count="28">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: np.sqrt(x)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="dv">0</span>, <span class="dv">10</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>plot_function_with_area(x, f, a<span class="op">=</span>a, b<span class="op">=</span>b, title<span class="op">=</span><span class="st">'$y=\sqrt</span><span class="sc">{x}</span><span class="st">$ on $[0,10]$'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="calculus_files/figure-html/cell-29-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>If you had to estimate the area of something like this with no prior knowledge, what you might do is try to approximate the area by using a shape you already know how to find the area of. Perhaps the easiest thing to try would be a rectangle. Suppose we took a rectangle whose base was length <span class="math inline">\(10\)</span> and whose height was <span class="math inline">\(\sqrt{10}\)</span>. Then very roughly speaking we could claim the area <span class="math inline">\(A\)</span> under the curve is</p>
<p><span class="math display">\[A \approx 10 \cdot \sqrt{10} \approx 31.62.\]</span></p>
<p>But this actually isn’t a great estimate. Here’s what we just calculated the area of. Notice how much area above the curve we’re taking with this estimate. We’re over-estimating the true area by a good bit it seems. How can we improve this estimate?</p>
<div class="cell" data-execution_count="29">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>plot_approximating_rectangles(x, f, dx<span class="op">=</span><span class="dv">10</span>, title<span class="op">=</span><span class="st">'$A </span><span class="ch">\\</span><span class="st">approx$ 1 Rectangle'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Approximate Area: 31.622776601683796</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="calculus_files/figure-html/cell-30-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>One thing we could do is use not one rectangle, but two rectangles. Suppose we took each rectangle to have half the width of the curve, say <span class="math inline">\(dx=5\)</span>. The left rectangle can have height <span class="math inline">\(\sqrt{5}\)</span>, and the right can have height <span class="math inline">\(\sqrt{10}\)</span>. If we sum up these two areas, we’d get</p>
<p><span class="math display">\[A \approx 5 \cdot \sqrt{5} + 5 \cdot \sqrt{10} \approx 26.99\]</span></p>
<p>Here’s what this approximation looks like. It’s clearly a lot better, but we’re still over-estimating the area by a decent bit.</p>
<div class="cell" data-execution_count="30">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>plot_approximating_rectangles(x, f, dx<span class="op">=</span><span class="dv">5</span>, title<span class="op">=</span><span class="st">'$A </span><span class="ch">\\</span><span class="st">approx $ 2 Rectangles'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Approximate Area: 26.991728188340847</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="calculus_files/figure-html/cell-31-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>It seems like we can keep going with this strategy though. Let’s try <span class="math inline">\(N=10\)</span> rectangles each of width <span class="math inline">\(dx=1\)</span>. Call the areas of these <span class="math inline">\(N\)</span> rectangles in order <span class="math inline">\(A_0, A_1, \cdots, A_{N-1}\)</span>. Each area will be a width <span class="math inline">\(dx\)</span> times a height <span class="math inline">\(y_i=\sqrt{i+1}\)</span>. Thus, we have</p>
<p><span class="math display">\[\begin{align*}
A \approx \sum_{i=0}^{N-1} A_i &amp;= \sum_{i=0}^{N-1} y_i dx \\
&amp;= y_0dx + y_1dx + y_2dx + \cdots + y_9dx \\
&amp;= \big(\sqrt{1} + \sqrt{2} + \sqrt{3} + \cdots + \sqrt{10}\big)\cdot 1 \\
&amp;\approx 22.468
\end{align*}\]</span></p>
<p>Here’s what this approximation looks like. It’s clearly a whole lot better. Notice how little extra area is left above the curve.</p>
<div class="cell" data-execution_count="31">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>plot_approximating_rectangles(x, f, dx<span class="op">=</span><span class="dv">1</span>, title<span class="op">=</span><span class="st">'$A </span><span class="ch">\\</span><span class="st">approx $ 10 Rectangles'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Approximate Area: 22.468278186204103</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="calculus_files/figure-html/cell-32-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now, it’s fair to ask if this approximation will ever become <em>exact</em>. Can we eventually take enough rectangles such that <span class="math inline">\(A = \sum y_i dx\)</span> exactly? In fact we can. The trick is to allow the rectangle widths <span class="math inline">\(dx\)</span> to become infinitesimally thin. If we do that, while taking <span class="math inline">\(N = \lfloor \frac{b-a}{dx} \rfloor\)</span> rectangles, then <span class="math inline">\(N\)</span> will become infinitely large and we’ll have an exact equality</p>
<p><span class="math display">\[A = \sum_{i=0}^{N-1} y_i dx.\]</span></p>
<p>Here’s what this might look like. Notice how for all practical purposes it looks like we’re calculating the area of the curve exactly now.</p>
<div class="cell" data-execution_count="32">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>plot_approximating_rectangles(x, f, dx<span class="op">=</span><span class="fl">0.1</span>, title<span class="op">=</span><span class="st">'$A </span><span class="ch">\\</span><span class="st">approx N$ Rectangles'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, print_area<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="calculus_files/figure-html/cell-33-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>What I’ve just shown is that the exact area under the curve of a function <span class="math inline">\(y=f(x)\)</span> is the sum of an infinitely large number of rectangles of height <span class="math inline">\(y_i=f(x_i)\)</span> and infinitesimal width <span class="math inline">\(dx\)</span>. For historical reasons we usually write a sum of infinitely many infinitesimals using a special notation,</p>
<p><span class="math display">\[\int_a^b y dx = \sum_{i=0}^{N-1} y_i dx.\]</span></p>
<p>This is called the <strong>definite integral</strong> of the function <span class="math inline">\(y=f(x)\)</span> from <span class="math inline">\(x=a\)</span> to <span class="math inline">\(x=b\)</span>. Historically, the reason the <span class="math inline">\(\int\)</span> was chosen is because it looks kind of like the S in “summa”, the Latin word for “sum”. This makes it clear that an integral is just a sum, a sum of infinitely many infinitesimal quantities <span class="math inline">\(ydx\)</span>.</p>
<p>Of course, this says nothing about how to actually calculate these things. We’ve got nothing to go on but the definition. For numerical purposes that’s good enough. If we wanted to calculate a definite integral numerically, we could just take a bunch of really small rectangles like this and sum them up.</p>
<p>Below I’ll define a function called <code>integrate</code> that will take in the function <code>f</code> and the endpoints <code>a</code> and <code>b</code>, and return the definite integral. Since it’s just an area, the definite integral will always be a numerical value. I’ll default <code>dx = 1e-4</code> to give a reasonable tradeoff between accuracy and speed.</p>
<p>I’ll use this function to estimate the area of our running example, namely</p>
<p><span class="math display">\[A = \int_0^{10} \sqrt{x} dx.\]</span></p>
<p>Evidently, the exact area in this case seems to be about <span class="math inline">\(A \approx 21.082\)</span>.</p>
<div class="cell" data-execution_count="33">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> integrate(f, a, b, dx<span class="op">=</span><span class="fl">1e-4</span>):</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="bu">int</span>((b <span class="op">-</span> a) <span class="op">/</span> dx)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    interval <span class="op">=</span> np.cumsum(dx <span class="op">*</span> np.ones(N))</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    rectangles <span class="op">=</span> np.array([f(x <span class="op">-</span> dx<span class="op">/</span><span class="dv">2</span>) <span class="op">*</span> dx <span class="cf">for</span> x <span class="kw">in</span> interval])</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    integral <span class="op">=</span> np.<span class="bu">sum</span>(rectangles)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> integral</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: np.sqrt(x)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="dv">0</span>, <span class="dv">10</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>area <span class="op">=</span> integrate(f, a, b)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'A = </span><span class="sc">{</span>area<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>A = 21.081851128609895</code></pre>
</div>
</div>
<p>This method of computing an integral is called <strong>numerical integration</strong>. We can actually improve the <code>integrate</code> function a lot by using <span class="math inline">\(f\big(x - \frac{dx}{2}\big) dx\)</span> for the rectangle areas instead of <span class="math inline">\(f(x)dx\)</span>. This is sometimes called the <em>midpoint rule</em>. It’s similar to differentiation, in that we improve convergence a lot by taking the midpoint function value instead of the right-most function value. As with differentiation, this centering trick reduces the error estimate by a factor of <span class="math inline">\(dx\)</span>. Doing this will allow you to use a much larger <span class="math inline">\(dx\)</span> value to get the same desired accuracy.</p>
<p>While it may not be obvious, the formula I gave to calculate the area under the curve actually calculates what’s called a <em>signed area</em>. That is, it counts area as positive when the curve is above the x-axis, and as negative when the curve is below the x-axis. To see this, notice if we took <span class="math inline">\(y=-\sqrt{x}\)</span>, we’d have</p>
<p><span class="math display">\[\int_0^{10} y dx = - \int_0^{10} \sqrt{x} dx \approx -21.082.\]</span></p>
<p>Why? Because this curve lies below the x-axis on the interval <span class="math inline">\(0 \leq x \leq 10\)</span>. This means the definite integral doesn’t calculate the area per se. It subtracts the area above the x-axis with the area below the x-axis.</p>
<p>While we can always calculate definite integrals numerically, and in practice this is what you’d usually do, we can also derive a formula to calculate them exactly in many cases. This formula is important because it’s what links together the indefinite integral with the definite integral, i.e.&nbsp;undoing the derivative with summing up infinitesimals areas. It’s called the <strong>Fundamental Theorem of Calculus</strong>.</p>
<p>Suppose we had a function <span class="math inline">\(F(x)\)</span> whose derivative is <span class="math inline">\(f(x)\)</span>. The fundamental theorem makes the following two claims:</p>
<ol type="1">
<li>For any left endpoint <span class="math inline">\(a\)</span>, the definite integral is given by <span class="math display">\[F(x) = \int_a^x f(t) dt + C,\]</span> where <span class="math inline">\(C\)</span> is some additive constant that depends only on <span class="math inline">\(a\)</span>.</li>
<li>For any interval <span class="math inline">\(a \leq x \leq b\)</span>, the area under the curve is given by <span class="math display">\[\int_a^b f(x) dx = F(b) - F(a).\]</span></li>
</ol>
<p>Note I had to use <span class="math inline">\(t\)</span> to represent the input variable in part (1) because I’m using <span class="math inline">\(x\)</span> as the right endpoint. The right endpoint and the integration variable are two different things, and you shouldn’t confuse them. To see why (1) is true, suppose <span class="math inline">\(A(x)\)</span> is the area under the curve of <span class="math inline">\(y=f(x)\)</span> from <span class="math inline">\(t=a\)</span> to <span class="math inline">\(t=x\)</span>, i.e.</p>
<p><span class="math display">\[A(x) = \int_a^x f(t) dt.\]</span></p>
<p>If we change the right endpoint <span class="math inline">\(t=x\)</span> by an infinitesimal amount <span class="math inline">\(dx\)</span>, the area <span class="math inline">\(A(x)\)</span> evidently changes by an amount</p>
<p><span class="math display">\[dA = A(x + dx) - A(x) = \int_x^{x+dx} f(t) dt \approx f(x) dx.\]</span></p>
<p>The last equality follows from the fact that <span class="math inline">\(dA\)</span> is just the area of a single rectangle of width <span class="math inline">\(dx\)</span> and height <span class="math inline">\(f(x)\)</span>. Since <span class="math inline">\(dF = f(x)dx\)</span> by definition, we thus have <span class="math inline">\(dF = dA\)</span>, which means <span class="math inline">\(F(x) = A(x) + C\)</span>, for some <span class="math inline">\(C\)</span> that doesn’t depend on <span class="math inline">\(x\)</span>. This shows part (1).</p>
<p>To show part (2), notice from (1) that I can write</p>
<p><span class="math display">\[F(b) - F(a) = \bigg(\int_a^b f(x) dx + C\bigg) - \bigg(\int_a^a f(x) dx + C\bigg) = \int_a^b f(x) dx.\]</span></p>
<p>The last equality follows from the fact that <span class="math inline">\(\int_a^a f(x) dx\)</span> is the area of a rectangle with no width, which must be zero. This shows part (2).</p>
<p>This theorem gives us an exact way to calculate the area under curves, provided we can evaluate the integral. For the previous example of finding the area under <span class="math inline">\(f(x)=\sqrt{x}\)</span> from <span class="math inline">\(x=0\)</span> to <span class="math inline">\(x=10\)</span>, we’d have</p>
<p><span class="math display">\[\begin{align*}
\int_0^{10} \sqrt{x} dx &amp;= \int_0^{10} x^{1/2} dx \\
&amp;= \frac{x^{3/2}}{3/2} \ \bigg|_{x=0}^{x=10} \\
&amp;= \frac{2}{3}x^{3/2} \ \bigg|_{x=0}^{x=10} \\
&amp;= \frac{2}{3} 10^{3/2} - \frac{2}{3} 0^{3/2} \approx 21.082. \\
\end{align*}\]</span></p>
<p>The notation <span class="math inline">\(F(x) \big|_{x=a}^{x=b}\)</span> is a common shorthand for writing <span class="math inline">\(F(b)-F(a)\)</span> in integral calculations like this. You can also use sympy to calculate definite integrals like this via the method <code>y.integrate((x, a, b))</code>.</p>
<div class="cell" data-execution_count="34">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> sp.sqrt(x)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> y.integrate((x, <span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'A = </span><span class="sc">{</span>A<span class="sc">}</span><span class="ss"> ≈ </span><span class="sc">{</span>A<span class="sc">.</span><span class="bu">round</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>A = 20*sqrt(10)/3 ≈ 21.082</code></pre>
</div>
</div>
<p>A couple more rules for the definite integral I’ll mention involve the endpoints <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, called the <strong>limits of integration</strong>. Since all we’re doing is summing up rectangles, we can always split up a sum over the interval <span class="math inline">\([a,b]\)</span> into a sum over two subintervals <span class="math inline">\([a,c]\)</span> and <span class="math inline">\([c,b]\)</span>. That is, if <span class="math inline">\(y=f(x)\)</span>, then</p>
<p><span class="math display">\[\int_a^b y dx = \int_a^c y dx + \int_c^d y dx.\]</span></p>
<p>We can also swap the limits of integration if we agree on the convention that doing so flips the sign of the integral,</p>
<p><span class="math display">\[\int_a^b y dx = -\int_b^a y dx.\]</span></p>
<p>We can even have either limit be infinite, provided that it makes sense to integrate the function over an infinite interval. We can do so as long as the output isn’t a NaN value like <span class="math inline">\(\infty - \infty\)</span>. For technical reasons these types of integrals are sometimes called <strong>improper integrals</strong>.</p>
<p>For example, suppose we had the function <span class="math inline">\(y=e^{-x}\)</span>. We can integrate this function from <span class="math inline">\(a=0\)</span> to <span class="math inline">\(b=\infty\)</span> just fine. First, notice that taking a change of variables <span class="math inline">\(u=-x\)</span> we get <span class="math inline">\(du=-dx\)</span>, so</p>
<p><span class="math display">\[\int e^{-x} dx = -\int e^u du = -e^{u} = -e^{-x}.\]</span></p>
<p>Then the definite integral is just</p>
<p><span class="math display">\[\int_0^\infty e^{-x} dx = -e^{-x} \ \bigg |_{x=0}^{x=\infty} = -e^{-\infty} + e^{-0} = 1.\]</span></p>
<p>The last equality follows from the fact that <span class="math inline">\(e^{-N} \approx 0\)</span> when <span class="math inline">\(N\)</span> is infinitely large. Strangely, the area under the curve of this infinite graph is exactly one. Curves with area one are called probability density functions. They can be used to create probability distributions. I’ll talk more on that in a few lessons.</p>
<div class="cell" data-execution_count="35">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: np.exp(<span class="op">-</span>x)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>plot_function_with_area(x, f, a<span class="op">=</span><span class="dv">0</span>, b<span class="op">=</span><span class="dv">10</span>, title<span class="op">=</span><span class="st">'$y=e^{-x}$'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="calculus_files/figure-html/cell-36-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-page-right">
  <div class="nav-page nav-page-previous">
      <a href="../notebooks/numerical-computing.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Numerical Computation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notebooks/linear-systems.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Linear Systems</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>